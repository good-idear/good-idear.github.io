<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<script src="https://me.idealli.com/images/load.gif" data-src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<meta name="theme-color" content="#222">

<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '菜菜鸡'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/Vue的入门笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/Vue的入门笔记/" itemprop="url">Vue的入门笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vuejs/" itemprop="url" rel="index">
                    <span itemprop="name">Vuejs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Vue的入门笔记"><a href="#Vue的入门笔记" class="headerlink" title="Vue的入门笔记"></a>Vue的入门笔记</h1><h2 id="1-0-vue的项目结构"><a href="#1-0-vue的项目结构" class="headerlink" title="1.0 vue的项目结构"></a>1.0 vue的项目结构</h2><p>这就是一个项目的结构<img src="D:%5CTypora%5CExpress%E5%AD%A6%E4%B9%A0%5Cvue%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png" alt></p>
<ul>
<li><p><code>config</code>文件夹里的<code>index.js</code>里面可以看到vue.js的一些配置，比如端口号之类的。</p>
</li>
<li><p><code>node_modules</code>里面存放的是一些第3方包</p>
</li>
<li><p><code>src</code>里面的项目目录，页面组件和主组件，自定义的 js 代码</p>
<ul>
<li><p><code>assets</code> 主要用来图片等静态静态资源。直接用<code>vue</code>里文件路径引入。(会被webpack打包进代码里面)</p>
</li>
<li><p><code>components</code>里面就存放许多vue的页面组件。使用时调用。</p>
</li>
<li><p><code>store</code> 项目的vuex文件，统一状态管理。</p>
</li>
<li><p><code>router</code>里面存放路由文件。</p>
</li>
<li><p><code>App.vue</code>页面主组件，相当于首页。</p>
</li>
</ul>
</li>
<li><p><code>static</code>存放一些类库文件，比如MUI,饿了么的element，js和css文件。（webpack不处理）</p>
</li>
<li><p><code>main.js</code>入口文件，引入了 vue模块 和 app.vue 组件 以及 路由router，我们需要在全局使用的一些东西也可以定义在这里面。</p>
</li>
</ul>
<h2 id="2-0-App-vue的配置"><a href="#2-0-App-vue的配置" class="headerlink" title="2.0 App.vue的配置"></a>2.0 App.vue的配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div&gt;</span><br><span class="line">       //模板里面只能有一个祖先div,一般负责app的首页UI渲染</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">	// 负责导出 .vue这个组件对象(它本质上是一个Vue对象,所以Vue中该定义的元素都可以使用)</span><br><span class="line">	export default&#123;  // es6的导出对象的写法</span><br><span class="line">		data()&#123;  //等价于 es5的 data:function()&#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		</span><br><span class="line">		created()&#123;</span><br><span class="line"></span><br><span class="line">		&#125;,</span><br><span class="line">		methods:&#123;</span><br><span class="line">			//方法</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">	//在样式中加了 scoped 的就是只允许在本页面中渲染</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-main-js的配置"><a href="#2-1-main-js的配置" class="headerlink" title="2.1 main.js的配置"></a>2.1 main.js的配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.0 导入vue核心包</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.0 导入App.vue的vue对象</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span>;</span><br><span class="line"><span class="comment">//3.0 引入路由模块</span></span><br><span class="line"><span class="keyword">import</span> vueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span><br><span class="line"><span class="comment">// 必须要加这句代码</span></span><br><span class="line">Vue.use(vueRouter);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> home <span class="keyword">from</span> <span class="string">'./components/Home.vue'</span>; <span class="comment">//首页</span></span><br><span class="line"><span class="keyword">import</span> shopcar <span class="keyword">from</span> <span class="string">'./components/shopcar/car.vue'</span>; <span class="comment">//购物车页面</span></span><br><span class="line"><span class="keyword">import</span> newslist <span class="keyword">from</span> <span class="string">'./components/news/newslist.vue'</span>; <span class="comment">//新闻页面</span></span><br><span class="line"><span class="keyword">import</span> newsinfo <span class="keyword">from</span> <span class="string">'./components/news/newsinfo.vue'</span>; <span class="comment">//新闻详情页面</span></span><br><span class="line"><span class="keyword">import</span> photolist <span class="keyword">from</span> <span class="string">'./components/photo/photolist.vue'</span>; <span class="comment">//图片分享</span></span><br><span class="line"><span class="keyword">import</span> photoinfo <span class="keyword">from</span> <span class="string">'./components/photo/photoinfo.vue'</span>; <span class="comment">//图片详情页面</span></span><br><span class="line"><span class="comment">// 进行路由设置</span></span><br><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> vueRouter(&#123;</span><br><span class="line">  linkActiveClass: <span class="string">'mui-active'</span>,<span class="comment">//全局使用 mui-active</span></span><br><span class="line">  routes: [&#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      redirect: <span class="string">'/home'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/home'</span>,</span><br><span class="line">      component: home</span><br><span class="line">    &#125; <span class="comment">//首页 </span></span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">import</span> <span class="string">'mint-ui/lib/style.min.css'</span>;</span><br><span class="line"><span class="comment">// 导入mint-ui组件对象</span></span><br><span class="line"><span class="keyword">import</span> mintui <span class="keyword">from</span> <span class="string">'mint-ui'</span>;</span><br><span class="line"><span class="comment">// 在Vue中全局使用mintui</span></span><br><span class="line">Vue.use(mintui);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.0 注册mui的css样式</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../statics/mui/css/mui.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../statics/css/site.css'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 6.0导入vue-resource进行ajax数据请求</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> vueResource <span class="keyword">from</span> <span class="string">'vue-resource'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绑定vueResource</span></span><br><span class="line">Vue.use(vueResource);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7.0实现全局过滤器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入所依赖的文件moment</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">'moment'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义全局过滤器</span></span><br><span class="line"></span><br><span class="line">Vue.filter(<span class="string">'datefmt'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">input, fmtstring</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> moment(input).format(fmtstring);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用vue-preview</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> VuePreview <span class="keyword">from</span> <span class="string">'vue-preview'</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(VuePreview);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.0 利用Vue对象进行解析渲染</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  router,</span><br><span class="line">  <span class="comment">// render:function(create)&#123;create(App)&#125; //es5的写法</span></span><br><span class="line">  render: <span class="function"><span class="params">c</span> =&gt;</span> c(App) <span class="comment">// es6的函数写法 =&gt;：goes to</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="3-0-主件的常用配置"><a href="#3-0-主件的常用配置" class="headerlink" title="3.0 主件的常用配置"></a>3.0 主件的常用配置</h2><h3 id="3-1-router-link和v-for"><a href="#3-1-router-link和v-for" class="headerlink" title="3.1 router-link和v-for"></a>3.1 router-link和v-for</h3><ul>
<li>使用<code>router-link</code>标签代替<code>a</code>标签</li>
<li>序列化信息<code>v-for</code>,在模板中使用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul class=&quot;mui-table-view&quot;&gt;</span><br><span class="line">				&lt;li v-for=&quot;item in list&quot; class=&quot;mui-table-view-cell mui-media&quot;&gt;</span><br><span class="line">					&lt;a :href=&quot;item.link&quot;&gt;//这里要 :href 表示绑定</span><br><span class="line">						&lt;img class=&quot;mui-media-object mui-pull-left&quot; :src=&quot;item.picInfo.url&quot;&gt;</span><br><span class="line">						&lt;div class=&quot;mui-media-body&quot;&gt;</span><br><span class="line">							&#123;&#123;item.title&#125;&#125;</span><br><span class="line">							&lt;p class=&apos;mui-ellipsis&apos;&gt;&#123;&#123;item.digest&#125;&#125;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">						&lt;/div&gt;</span><br><span class="line">					&lt;/a&gt;</span><br><span class="line">				&lt;/li&gt;</span><br><span class="line">		&lt;/ul&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>在<code>script</code>中加上js代码</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">		data()&#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">				list:[]	</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		created()&#123;</span><br><span class="line">			<span class="keyword">this</span>.getnewslist();</span><br><span class="line">		&#125;,</span><br><span class="line">		methods:&#123;</span><br><span class="line">			getnewslist() &#123;</span><br><span class="line">				<span class="comment">//1.0 确定url,请求的 api 的地址</span></span><br><span class="line">				<span class="keyword">var</span> url = <span class="string">'https://www.apiopen.top/journalismApi'</span>;</span><br><span class="line">				<span class="comment">//2.0 利用$http.get方法请求到数据</span></span><br><span class="line">				<span class="keyword">this</span>.$http.get(url).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">					<span class="comment">//3.0 获取响应报文体数据</span></span><br><span class="line">					<span class="keyword">var</span> body = res.body;</span><br><span class="line">					<span class="comment">//4.0 判断响应报文体的状态值</span></span><br><span class="line">					<span class="keyword">if</span>(body.code != <span class="number">200</span>) &#123;</span><br><span class="line">						alert(<span class="string">"请求错误"</span>);</span><br><span class="line">						<span class="keyword">return</span>;</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="keyword">this</span>.list = body.data.tech;</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-利用vue-cli创建一个项目"><a href="#3-2-利用vue-cli创建一个项目" class="headerlink" title="3.2 利用vue-cli创建一个项目"></a>3.2 利用vue-cli创建一个项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack -g</span><br><span class="line">npm install vue-cli -g	//全局安装vue-cli 脚手架工具</span><br></pre></td></tr></table></figure>

<ul>
<li>项目创建过程中会提示是否安装eslint，可以选择不安装，否则项目编译过程中出现各种代码格式的问题；</li>
<li><code>cd 工作文件夹</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vue init webpack 项目文件</span><br><span class="line"><span class="built_in">cd</span> 项目文件</span><br><span class="line">npm install	//不要使用cnpm,因为会有许多依赖包缺失</span><br><span class="line">npm run dev //启动成功</span><br></pre></td></tr></table></figure>

<h3 id="3-3-vue的代理与跨域"><a href="#3-3-vue的代理与跨域" class="headerlink" title="3.3 vue的代理与跨域"></a>3.3 vue的代理与跨域</h3><ul>
<li>vue-cli的config文件中有一个proxyTable参数，用来设置地址映射表，可以添加到开发时配置（dev）中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dev: &#123;</span><br><span class="line">    // ...</span><br><span class="line">    proxyTable: &#123;</span><br><span class="line">        &apos;/api&apos;: &#123;</span><br><span class="line">            target: &apos;http://127.0.0.1:3000/api/&apos;,</span><br><span class="line">            changeOrigin: true,</span><br><span class="line">            pathRewrite: &#123;</span><br><span class="line">                &apos;^/api&apos;: &apos;&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在vue+koa中，前端页面和koa后端在不同的端口，前端请求的数据就表示为跨域，所以需要在config/index.js中设置。</p>
<p>这里实际上是webpack帮我们代理了localhost的8889端口的服务，所以我们可以把实际是跨域的请求当做是同域下的接口来调用。</p>
<p>即请求/api时就代表<a href="http://127.0.0.1:3000/api/(这里要写ip，不要写localhost)，" target="_blank" rel="noopener">http://127.0.0.1:3000/api/(这里要写ip，不要写localhost)，</a> changeOrigin参数接收一个布尔值，如果为true，这样就不会有跨域问题了。</p>
</blockquote>
<h3 id="3-4-vue的原生过渡-动画"><a href="#3-4-vue的原生过渡-动画" class="headerlink" title="3.4 vue的原生过渡/动画"></a>3.4 vue的原生过渡/动画</h3><p>vue的动画与过渡大致上分为2个状态，是opacity的状态从0到1，再从1到0，在这2个状态的之间的过渡和动画，</p>
<p>所以简单的过渡/动画，才会在在进入和离开的类名下定义相同的css样式。</p>
<ul>
<li>css 过渡</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition name=&quot;bottomdown&quot; @touchmove.prevent&gt; </span><br><span class="line">	//v-show的渲染结束，并没有销毁改元素，v-if 的调用就是销毁与重建。一般使用v-show ，视渲染的元素而定。条件渲染定义在动画的包裹的盒子里面，当为true才开始渲染盒子，动画开始</span><br><span class="line">    &lt;div class=&quot;bottom-mask&quot; v-show=&quot;isBottomNav&quot; @click=&quot;hideBottom&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/transition&gt;</span><br><span class="line">&lt;transition name=&quot;bottomDiv&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;bottomDivNav&quot; v-show=&quot;isBottomNav&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/transition&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>vue</code>的过渡通过transition 的name属性绑定，会自动生成6个类名，看具体功能调用几个，一般4个就差不多</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 进行中动画的状态</span><br><span class="line"><span class="selector-class">.bottom-enter-active</span>, <span class="selector-class">.bottom-leave-active</span>&#123;</span><br><span class="line">    <span class="attribute">transition</span>:opacity .<span class="number">5s</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 动画开始和结束的状态</span><br><span class="line"><span class="selector-class">.bottom-enter-to</span>, <span class="selector-class">.bottom-leave-to</span>&#123;</span><br><span class="line">    <span class="attribute">opacity</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>css原生动画</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> &lt;button @click=&quot;show = !show&quot;&gt;Toggle show&lt;/button&gt;</span><br><span class="line">  &lt;transition name=&quot;bounce&quot;&gt;</span><br><span class="line">    &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.bounce-enter-active &#123;</span><br><span class="line">  animation: bounce-in .5s;</span><br><span class="line">&#125;</span><br><span class="line">.bounce-leave-active &#123;</span><br><span class="line">  animation: bounce-in .5s reverse;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes bounce-in &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    transform: scale(0);</span><br><span class="line">  &#125;</span><br><span class="line">  50% &#123;</span><br><span class="line">    transform: scale(1.5);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    transform: scale(1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>可以和第3方库结合使用（animate.css），同样有6种过渡类名,在相应的状态类名下定义名字即可</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition</span><br><span class="line">    name=&quot;custom-classes-transition&quot;</span><br><span class="line">    enter-active-class=&quot;animated tada&quot;  // 这里的类名与animate.css的类名相同即可调用</span><br><span class="line">    leave-active-class=&quot;animated bounceOutRight&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-5-嵌套路由"><a href="#3-5-嵌套路由" class="headerlink" title="3.5 嵌套路由"></a>3.5 嵌套路由</h3><p>在router/index.js中的路由配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">    routes:[</span><br><span class="line">        &#123;</span><br><span class="line">    	path:<span class="string">'/bookCity'</span>,</span><br><span class="line">    	component:bookCity, <span class="comment">//组件</span></span><br><span class="line">    	children:[</span><br><span class="line">    		&#123;</span><br><span class="line">    			path:<span class="string">'select'</span>,</span><br><span class="line">    			component:select</span><br><span class="line">    		&#125;,</span><br><span class="line">    		&#123;					<span class="comment">//2种写法，一种 toplist</span></span><br><span class="line">    			path:<span class="string">'/bookCity/toplist'</span>,<span class="comment">//使用/bookCity/toplist,即要加父路由，否则匹配不到相应的组件，还不会报错,因为使用 /toplist的话 是使用根路径即在localhost:8080/toplist下渲染，和嵌套路径不一样</span></span><br><span class="line">    			component:toplist</span><br><span class="line">    		&#125;,</span><br><span class="line">    		&#123;</span><br><span class="line">    			path:<span class="string">'booklist'</span>,</span><br><span class="line">    			component:booklist</span><br><span class="line">    		&#125;</span><br><span class="line">    	]</span><br><span class="line">    &#125;</span><br><span class="line">    ] </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在使用嵌套路由时，必须要在父路由的页面组件使用<code>&lt;router-view&gt;&lt;/router-view&gt;</code>,这句代码就是字路由的组件渲染的地方，否则子路由的渲染不到。</p>
<h3 id="3-6-数据请求axios"><a href="#3-6-数据请求axios" class="headerlink" title="3.6 数据请求axios"></a>3.6 数据请求axios</h3><p>在vue中推荐使用axios来进行ajax请求</p>
<ul>
<li>修改原型链引用</li>
</ul>
<p>在main.js中添加</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line">Vue.prototype.$http = axios	<span class="comment">// 	相当于使用</span></span><br><span class="line"><span class="comment">// 执行get请求 代码写在created中</span></span><br><span class="line"><span class="keyword">this</span>.$http.get(<span class="string">'/user?ID=123456'</span>)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">	&#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>局部组件使用(按需使用)</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created()&#123;</span><br><span class="line">        <span class="comment">//	如果直接在axios里面使用 this 的话，this指向的是axios本身，会报错</span></span><br><span class="line">	      <span class="keyword">var</span> _this = <span class="keyword">this</span></span><br><span class="line">	      <span class="keyword">let</span> Api = <span class="string">'https://www.apiopen.top/novelInfoApi?name=%E7%9B%97%E5%A2%93%E7%AC%94%E8%AE%B0'</span></span><br><span class="line">	      axios.get(Api)</span><br><span class="line">	      .then( <span class="function"><span class="keyword">function</span>(<span class="params"> response </span>) </span>&#123;</span><br><span class="line">	      	</span><br><span class="line">	      	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i &lt; <span class="number">3</span> ;i++)&#123;</span><br><span class="line">	      		_this.apiInfo.push(response.data.data.data[i])</span><br><span class="line">	      	&#125;</span><br><span class="line">	      	<span class="comment">// 把获取的数组的 3 个小说信息存储</span></span><br><span class="line">	      	store.dispatch(<span class="string">'Set_bookList'</span>, _this.apiInfo)</span><br><span class="line">	      	_this.isLoading = <span class="literal">false</span> </span><br><span class="line">	      &#125; )</span><br><span class="line">	      .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">	      	<span class="built_in">console</span>.log(<span class="string">'出错'</span>)</span><br><span class="line">	      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-7-vue-的生命周期"><a href="#3-7-vue-的生命周期" class="headerlink" title="3.7 vue 的生命周期"></a>3.7 vue 的生命周期</h3><p><img src="D:%5CTypora%5CExpress%E5%AD%A6%E4%B9%A0%5Cvue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.webp" alt></p>
<table>
<thead>
<tr>
<th align="center">钩子函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">beforeCerate</td>
<td>组件实例刚刚被创建，组件属性计算之前，如data属性</td>
</tr>
<tr>
<td align="center">created</td>
<td>组件实例创建完成，属性已绑定，但DOM还未生成，$el属性还不存在，所以在这里进行axios的数据请求依旧可以正常渲染。</td>
</tr>
<tr>
<td align="center">beforeMount</td>
<td>模板编译/挂载之前，这里开始渲染，调用相关的<code>render</code></td>
</tr>
<tr>
<td align="center">mounted</td>
<td>模板编译/挂载之后（一般组件到这里就渲染完成了）</td>
</tr>
<tr>
<td align="center">beforeUpdate</td>
<td>组件更新之前（当data中的数据改变之后开始调用）</td>
</tr>
<tr>
<td align="center">updated</td>
<td>组件更新之后</td>
</tr>
<tr>
<td align="center">activated</td>
<td>组件被激活时调用（使用了keep-alive，keep-alive会保存数据，不用再次请求数据）</td>
</tr>
<tr>
<td align="center">deactivated</td>
<td>组件被移除时调用</td>
</tr>
<tr>
<td align="center">beforeDestory</td>
<td>组件销毁前</td>
</tr>
<tr>
<td align="center">destory</td>
<td>组件销毁后调用</td>
</tr>
</tbody></table>
<h3 id="3-8-Vue的全局API"><a href="#3-8-Vue的全局API" class="headerlink" title="3.8 Vue的全局API"></a>3.8 Vue的全局API</h3><h4 id="3-8-1-Vue-nextTick"><a href="#3-8-1-Vue-nextTick" class="headerlink" title="3.8.1 Vue.nextTick()"></a>3.8.1 Vue.nextTick()</h4><p><code>nextTick()</code>的场景需求：当接收数据之后，需要调用数据渲染出来，但是会改变dom结构，如果只是将这个数据请求放在<code>methods</code>中是无效的，也就是无法将得到的数据重新渲染出来。</p>
<blockquote>
<p>在数据变化后要执行的某个操作，而这个操作需要使用随数据改变而改变的DOM结构的时候，这个操作都应该放进<code>Vue.nextTick()</code>的回调函数中。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ceratd()&#123;</span><br><span class="line">    <span class="comment">// 异步动作</span></span><br><span class="line">    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">				<span class="comment">// 获取所有书的数组</span></span><br><span class="line">				<span class="keyword">this</span>.bookList = store.getters.getBookList</span><br><span class="line">				<span class="comment">//console.log(this.bookList)</span></span><br><span class="line">				<span class="keyword">this</span>.readId = store.getters.getReadBookId</span><br><span class="line">				<span class="keyword">this</span>.index = <span class="keyword">this</span>.readId.length;</span><br><span class="line">				<span class="comment">//console.log(this.readId)</span></span><br><span class="line">				<span class="keyword">var</span> bookLength = <span class="keyword">this</span>.bookList.length</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">var</span> i= <span class="number">0</span>;i &lt; bookLength;i++)&#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j&lt; bookLength;j++)&#123;</span><br><span class="line">						<span class="keyword">if</span> (<span class="keyword">this</span>.readId[i] == <span class="keyword">this</span>.bookList[j].bid) &#123;</span><br><span class="line">							<span class="comment">//console.log('sb')</span></span><br><span class="line">							<span class="keyword">this</span>.book.push(<span class="keyword">this</span>.bookList[j])</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-8-2-Vue-filter"><a href="#3-8-2-Vue-filter" class="headerlink" title="3.8.2 Vue.filter()"></a>3.8.2 Vue.filter()</h4><p>注册或获取过滤器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在这里的statusUpdate过滤器，会接收item.status的值，进行转换，再进行渲染出来。</span></span><br><span class="line">&#123;&#123;item.status | statusUpdate&#125;&#125;</span><br><span class="line"><span class="comment">// 在组件中使用</span></span><br><span class="line">filters:&#123;</span><br><span class="line">			<span class="comment">// 局部过滤器</span></span><br><span class="line">    		<span class="comment">// 参数value就是前面的item.status</span></span><br><span class="line">			statusUpdate: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">				<span class="keyword">let</span> statusEnd = <span class="string">''</span></span><br><span class="line">				<span class="keyword">switch</span>( value) &#123;</span><br><span class="line">					<span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">						statusEnd = <span class="string">'完结'</span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">						statusEnd = <span class="string">'连载'</span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> statusEnd</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-8-3-Vue-set-target-key-value"><a href="#3-8-3-Vue-set-target-key-value" class="headerlink" title="3.8.3 Vue.set(target, key, value)"></a>3.8.3 Vue.set(target, key, value)</h4><p><code>this.$set(this.list[index],&#39;status&#39;,true)</code> 通过set的方法让数组的变动能够让Vue检测到,从而跟新视图。</p>
<h2 id="4-0-webpack的学习"><a href="#4-0-webpack的学习" class="headerlink" title="4.0 webpack的学习"></a>4.0 webpack的学习</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> htmlwp = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">	entry:<span class="string">'./src/main.js'</span>,  <span class="comment">// 指定打包的入口文件</span></span><br><span class="line">	output:&#123;						<span class="comment">//__dirname 是指当前文件夹的绝对路径</span></span><br><span class="line">		path:__dirname+<span class="string">'/dist'</span>,     <span class="comment">//wenpack@1.14.0 要求这个路径是绝对路径</span></span><br><span class="line">		filename:<span class="string">'build.js'</span>			<span class="comment">//打包后的文件名字</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="built_in">module</span>:&#123;</span><br><span class="line">		loaders:[</span><br><span class="line">			&#123;</span><br><span class="line">				test:<span class="regexp">/\.css$/</span>,</span><br><span class="line">				loader:<span class="string">'style-loader!css-loader'</span>  <span class="comment">//顺序不能改</span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				test:<span class="regexp">/\.scss$/</span>,</span><br><span class="line">				loader:<span class="string">'style-loader!css-loader!sass-loader'</span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				test:<span class="regexp">/\.less$/</span>,</span><br><span class="line">				loader:<span class="string">'style-loader!css-loader!less-loader'</span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				test:<span class="regexp">/\.(png|jpg|gif)$/</span>,         <span class="comment">//打包请求的url的资源文件</span></span><br><span class="line">				loader:<span class="string">'url-loader?limit=40000'</span>  <span class="comment">//limit 表示限制图片的大小为 40K </span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				test:<span class="regexp">/\.js$/</span>,</span><br><span class="line">				loader:<span class="string">'babel-loader'</span>,</span><br><span class="line">				exclude:<span class="regexp">/node_modules/</span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				test:<span class="regexp">/\.vue$/</span>,</span><br><span class="line">				loader:<span class="string">'vue-loader'</span></span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;,</span><br><span class="line">	babel:&#123;</span><br><span class="line">		presets:[<span class="string">'es2015'</span>],   <span class="comment">//将 es6 转化为 es5</span></span><br><span class="line">		plugins:[<span class="string">'transform-runtime'</span>]  <span class="comment">// 配合 vue.js</span></span><br><span class="line">	&#125;,</span><br><span class="line">	plugins:[</span><br><span class="line">		<span class="keyword">new</span> htmlwp(&#123;</span><br><span class="line">			title:<span class="string">'首页'</span>,</span><br><span class="line">			filename:<span class="string">'index.html'</span>,<span class="comment">// webpack-dev-server 在内存中生成的文件名称</span></span><br><span class="line">			template:<span class="string">'index1.html'</span><span class="comment">//由这个模板生成</span></span><br><span class="line">		&#125;)</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Webpack的工作方式是：把你的项目当做一个整体，通过一个给定的主文件（如：main.js），Webpack将从这个文件开始找到你的项目的所有依赖文件，使用loaders处理它们，最后打包为一个浏览器可识别的JavaScript文件。</li>
</ul>
<h2 id="5-0-Gulp-的学习"><a href="#5-0-Gulp-的学习" class="headerlink" title="5.0 Gulp 的学习"></a>5.0 Gulp 的学习</h2><p>参考资料：<a href="https://www.cnblogs.com/chuaWeb/p/gulp.html" target="_blank" rel="noopener">https://www.cnblogs.com/chuaWeb/p/gulp.html</a></p>
<h2 id="6-0-Vuex-的使用"><a href="#6-0-Vuex-的使用" class="headerlink" title="6.0 Vuex 的使用"></a>6.0 Vuex 的使用</h2><ul>
<li><code>state</code> :<code>Vuex</code> 使用单一状态树，用一个对象就包含了全部的应用层级状态。至此它便作为一个『唯一数据源(SSOT)』而存在。这也意味着，每个应用将仅仅包含一个 store 实例。单状态树让我们能够直接地定位任一特定的状态片段，在调试的过程中也能轻易地取得整个当前应用状态的快照。</li>
<li><code>Getters</code>:用来从 store 获取 Vue 组件数据。</li>
<li><code>Mutators</code>: 事件处理器用来驱动状态的变化。</li>
<li><code>Actions</code>: 可以给组件使用的函数，以此用来驱动事件处理器 mutations</li>
</ul>
<p><strong>关键点</strong>：</p>
<blockquote>
<p>Vuex 规定，属于应用层级的状态只能通过 Mutation 中的方法来修改，而派发 Mutation 中的事件只能通过 action。</p>
<p>从组件出发，组件中调用 action，在 action 这一层级我们可以和后台数据交互，比如获取初始化的数据源，或者中间数据的过滤等。然后在 action 中去派发 Mutation。Mutation 去触发状态的改变，状态的改变，将触发视图的更新。</p>
</blockquote>
<p><strong>注意点</strong>：</p>
<ul>
<li>数据流单项传递</li>
<li>组件能够调用<code>action</code></li>
<li><code>action</code>通过<code>dispatch</code>派发Mutation</li>
<li>只有<code>mutation</code>改变state状态</li>
<li><code>store</code>是响应式的，无论state什么时候更新，组件同步更新。</li>
</ul>
<p><img src="D:%5CTypora%5CExpress%E5%AD%A6%E4%B9%A0%5Cvuex.png" alt="vuex的流程图"></p>
<p>在<code>index.js</code>中的代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="keyword">import</span> Sidebar <span class="keyword">from</span> <span class="string">'./modules/sidebar.js'</span></span><br><span class="line"><span class="keyword">import</span> Details <span class="keyword">from</span> <span class="string">'./modules/details.js'</span></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">	modules:&#123;</span><br><span class="line">		sidebar:Sidebar,  <span class="comment">//模块调用</span></span><br><span class="line">		details:Details	  </span><br><span class="line">	&#125;	</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>

<p><strong>export 与export default 的区别</strong></p>
<ul>
<li>在一个文件或模块中，export、import可以有多个，export default仅有一个。</li>
<li>通过export方式导出，在导入时要加{ }，export default则不需要</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/React+redux+typescript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/React+redux+typescript/" itemprop="url">React+redux+ts</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/React/" itemprop="url" rel="index">
                    <span itemprop="name">React</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="React-redux-ts的代办事项"><a href="#React-redux-ts的代办事项" class="headerlink" title="React+redux+ts的代办事项"></a>React+redux+ts的代办事项</h1><p><strong>这次也是模仿大佬的项目，大致上的东西差不多，主要是为了练习一下react,ts,redux,因为之前一致对数据流概念不太清楚，又接触到了typescript，所以就入坑了。大佬项目地址：</strong></p>
<p>[<a href="https://github.com/jackluson/todolist--redux-hook-react]" target="_blank" rel="noopener">https://github.com/jackluson/todolist--redux-hook-react]</a>: </p>
<p>而且在网上有些类似项目太难了，对新手不够友好，所以我就尝试写了一下，也可以看作是对大佬项目的注释。</p>
<blockquote>
<p>读这篇文章需要对<code>typescript</code>的声明和约束懂一些，<code>react</code>和<code>redux</code>都了解，不然步子太大也很难理解。</p>
</blockquote>
<h2 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1. 创建项目"></a>1. 创建项目</h2><p><code>./packahe.json</code>,这是项目的包的版本，读者直接下载我的配置文件直接安装也行，raect版本是16+的</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"my-app2"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.1.0"</span>,</span><br><span class="line">  <span class="attr">"private"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"@emotion/core"</span>: <span class="string">"^10.0.10"</span>,</span><br><span class="line">    <span class="attr">"@types/jest"</span>: <span class="string">"24.0.12"</span>,</span><br><span class="line">    <span class="attr">"@types/node"</span>: <span class="string">"12.0.0"</span>,</span><br><span class="line">    <span class="attr">"@types/react"</span>: <span class="string">"16.8.17"</span>,</span><br><span class="line">    <span class="attr">"@types/react-dom"</span>: <span class="string">"16.8.4"</span>,</span><br><span class="line">    <span class="attr">"@types/react-redux"</span>: <span class="string">"^7.0.9"</span>,</span><br><span class="line">    <span class="attr">"emotion"</span>: <span class="string">"^10.0.9"</span>,</span><br><span class="line">    <span class="attr">"react"</span>: <span class="string">"^16.8.6"</span>,</span><br><span class="line">    <span class="attr">"react-dom"</span>: <span class="string">"^16.8.6"</span>,</span><br><span class="line">    <span class="attr">"react-redux"</span>: <span class="string">"^7.0.3"</span>,</span><br><span class="line">    <span class="attr">"react-scripts"</span>: <span class="string">"3.0.1"</span>,</span><br><span class="line">    <span class="attr">"redux"</span>: <span class="string">"^4.0.1"</span>,</span><br><span class="line">    <span class="attr">"typescript"</span>: <span class="string">"3.4.5"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"react-scripts start"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"react-scripts build"</span>,</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"react-scripts test"</span>,</span><br><span class="line">    <span class="attr">"eject"</span>: <span class="string">"react-scripts eject"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"eslintConfig"</span>: &#123;</span><br><span class="line">    <span class="attr">"extends"</span>: <span class="string">"react-app"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"browserslist"</span>: &#123;</span><br><span class="line">    <span class="attr">"production"</span>: [</span><br><span class="line">      <span class="string">"&gt;0.2%"</span>,</span><br><span class="line">      <span class="string">"not dead"</span>,</span><br><span class="line">      <span class="string">"not op_mini all"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"development"</span>: [</span><br><span class="line">      <span class="string">"last 1 chrome version"</span>,</span><br><span class="line">      <span class="string">"last 1 firefox version"</span>,</span><br><span class="line">      <span class="string">"last 1 safari version"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>菜鸟当然是使用脚手架咯！</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局安装ts</span></span><br><span class="line"><span class="string">npm </span><span class="string">install </span>-g <span class="string">typescript</span></span><br><span class="line"><span class="string">#</span> 全局安装<span class="built_in">create-react-app</span></span><br><span class="line"><span class="built_in">npm</span> <span class="string">install </span>-g <span class="built_in">create-react-app</span></span><br><span class="line"><span class="built_in">#</span> 创建项目</span><br><span class="line"><span class="built_in">create-react-app</span> 项目名 <span class="built_in">--scripts-version=react-scripts-ts</span></span><br><span class="line"><span class="built_in">#</span> 启动项目</span><br><span class="line"><span class="string">npm </span><span class="string">run </span><span class="string">start</span></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>tsconfig.json包含了工程里TypeScript特定的选项。</li>
<li>tslint.json保存了要使用的代码检查器的设置，TSLint。</li>
<li>package.json包含了依赖，还有一些命令的快捷方式，如测试命令，预览命令和发布应用的命令。</li>
<li>public包含了静态资源如HTML页面或图片。除了index.html文件外，其它的文件都可以删除。</li>
<li>src包含了TypeScript和CSS源码。index.tsx是强制使用的入口文件。</li>
</ul>
<blockquote>
<p>安装全局的命令包我推荐使用<code>npm</code>，然后之后的安装其它包就使用<code>yarn</code>,<code>yarn</code> 下载包的速度更快。只要学习一下yarn的命令就行了。</p>
</blockquote>
<h2 id="2-主要说明"><a href="#2-主要说明" class="headerlink" title="2. 主要说明"></a>2. 主要说明</h2><h3 id="2-1-使用redux-tools"><a href="#2-1-使用redux-tools" class="headerlink" title="2.1 使用redux-tools"></a>2.1 使用<code>redux-tools</code></h3><blockquote>
<p>需要先在浏览器上安装相应的react插件<code>Redux DevTools</code>,才有效</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 原来会报错：window上不存在属性__REDUX_DEVTOOLS_EXTENSION__，</span><br><span class="line">// 所以就全局声明一个变量</span><br><span class="line">declare global &#123;</span><br><span class="line">    interface Window &#123;</span><br><span class="line">        __REDUX_DEVTOOLS_EXTENSION__:any</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION__ || compose;</span><br><span class="line">// 这是根 state 的约束</span><br><span class="line">export interface IRootState &#123;</span><br><span class="line">    demo: Storestate</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const store = createStore&lt;any, any, any,any&gt;(reducer, composeEnhancers())</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">       &lt;App/&gt; </span><br><span class="line">    &lt;/Provider&gt;</span><br><span class="line">    , </span><br><span class="line">    document.getElementById(&apos;root&apos;) as HTMLElement);</span><br><span class="line"></span><br><span class="line">serviceWorker.unregister();</span><br></pre></td></tr></table></figure>

<h3 id="2-2-使用redux"><a href="#2-2-使用redux" class="headerlink" title="2.2 使用redux"></a>2.2 使用<code>redux</code></h3><ul>
<li>使用<code>mapStateToProps</code>,是把<code>state</code>的数据当成<code>props</code>注入到相应组件中</li>
<li>使用<code>mapDispatchToProps</code>是把<code>dispatch</code>当成<code>props</code>注入组件中,可以通过<code>this.props.actionTodo</code>来调用该函数，进而触发<code>根store</code>的更新</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// 引入state的类型  第二个参数可以为null</span><br><span class="line">const mapStateToProps = (state: Storestate, ownProps: listProps) =&gt; &#123;</span><br><span class="line">  let data = &#123;</span><br><span class="line">    todo:state.todos || [],</span><br><span class="line">    done:state.done || [],</span><br><span class="line">    undo:state.undo || [],</span><br><span class="line">    lastUpdated: state.lastUpdated</span><br><span class="line">  &#125;</span><br><span class="line">  //console.log(data)</span><br><span class="line">    return&#123;</span><br><span class="line">      data:data</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line">// dispath的类型为Dispatch,需要引入类型 import &#123; Dispatch &#125; from &apos;redux&apos;在头部</span><br><span class="line">const mapDispatchToProps = (dispatch: Dispatch, ownProps: listProps) =&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        // 可以通过this.props.actionTodo来调用该函数，进而触发根store的更新</span><br><span class="line">        actionTodo: (obj:Action1) =&gt; &#123;</span><br><span class="line">            dispatch(obj)</span><br><span class="line">        &#125;,</span><br><span class="line">        action2Todo: (obj:Action1) =&gt; &#123;</span><br><span class="line">            dispatch(obj)</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 如果只需要一个函数，另一个直接为null</span><br><span class="line">//export default connect(null, mapDispatchToProps)(TodoItem)</span><br><span class="line">export default connect(mapStateToProps,mapDispatchToProps)(TodoItem)</span><br></pre></td></tr></table></figure>

<h3 id="2-3-action-ts"><a href="#2-3-action-ts" class="headerlink" title="2.3 action.ts"></a>2.3 <code>action.ts</code></h3><blockquote>
<p>是用来规范函数的作用，以及传参给该函数进行调用。</p>
</blockquote>
<ul>
<li>传统写法</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * action 类型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ADD_TODO = <span class="string">'ADD_TODO'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> TOGGLE_TODO = <span class="string">'TOGGLE_TODO'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_VISIBILITY_FILTER = <span class="string">'SET_VISIBILITY_FILTER'</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * action 创建函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: ADD_TODO, text &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">toggleTodo</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: TOGGLE_TODO, index &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">setVisibilityFilter</span>(<span class="params">filter</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: SET_VISIBILITY_FILTER, filter &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>骚操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 当使用固定值时，是可以当作类型的，所以才这样混写</span><br><span class="line">export type Action = </span><br><span class="line">    &#123;</span><br><span class="line">        type: &quot;add todo&quot;;       // 增加待办事项</span><br><span class="line">        todo: string;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;done todo&quot;;      // 已完成的待办事项</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;cancel todo&quot;;    // 取消待办事项</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;withdraw todo&quot;;</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;delete todo&quot;;    // 删除事项</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;restore todo&quot;;</span><br><span class="line">        index: number;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>但是如果只是这样写的话，会报错：</p>
<p>不能将类型“string”分配给类型“”add todo” | “done todo” | “cancel todo” | “withdraw todo” | “delete todo” | “restore todo”</p>
<p>我的不知道为什么会报错，大佬就不会。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//这里的Action1本来应该是Action，但是会报上面的错，</span><br><span class="line">//所以需要在action.ts添加类型。</span><br><span class="line">interface doListProps extends listProps &#123;</span><br><span class="line">    index: number;</span><br><span class="line">    actionTodo:(obj:Action1)=&gt;void; </span><br><span class="line">    action2Todo:(obj:Action1)=&gt;void;</span><br><span class="line">    //data: any;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>完整的<code>action.ts</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">//这里有类型就ok了</span><br><span class="line">export interface Action1&#123;</span><br><span class="line">    type: string;</span><br><span class="line">    todo?:string;</span><br><span class="line">    index?:number;</span><br><span class="line">&#125;</span><br><span class="line">// 确定action的接口模式</span><br><span class="line">export type Action = </span><br><span class="line">    &#123;</span><br><span class="line">        type: &quot;add todo&quot;;       // 增加待办事项</span><br><span class="line">        todo: string;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;done todo&quot;;      // 已完成的待办事项</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;cancel todo&quot;;    // 取消待办事项</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;withdraw todo&quot;;</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;delete todo&quot;;    // 删除事项</span><br><span class="line">        index: number;</span><br><span class="line">    &#125; | &#123;</span><br><span class="line">        type: &quot;restore todo&quot;;</span><br><span class="line">        index: number;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-type-ts"><a href="#2-3-type-ts" class="headerlink" title="2.3 type.ts"></a>2.3 <code>type.ts</code></h3><blockquote>
<p>用来确定根store的类型，或者全局变量的类型</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 完成的状态</span><br><span class="line">export interface doneState &#123;</span><br><span class="line">    content: string;</span><br><span class="line">    date: string;</span><br><span class="line">&#125;</span><br><span class="line">// 这里的类型需要在index.tsx中使用</span><br><span class="line">export interface Storestate &#123;</span><br><span class="line">    lastUpdated: number;</span><br><span class="line">    todos: string[];    // 代办事项的数据</span><br><span class="line">    done: doneState[];  // 已完成的数据</span><br><span class="line">    undo: string[];     // 取消的事项</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-reducer-ts"><a href="#2-4-reducer-ts" class="headerlink" title="2.4 reducer.ts"></a>2.4 <code>reducer.ts</code></h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Storestate, doneState &#125; <span class="keyword">from</span> <span class="string">'./types'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Action &#125; <span class="keyword">from</span> <span class="string">'./actions'</span></span><br><span class="line"><span class="keyword">import</span> &#123; todoUtils &#125; <span class="keyword">from</span> <span class="string">'../utils/index'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当天的日期</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getDate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    <span class="keyword">const</span> mouth = date.getMonth() + <span class="number">1</span> &lt; <span class="number">10</span> ? <span class="string">"0"</span> + (date.getMonth() + <span class="number">1</span>) : date.getMonth() + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> day = date.getDate() &lt; <span class="number">10</span> ? <span class="string">"0"</span> + date.getDate() : date.getDate()</span><br><span class="line">    <span class="keyword">return</span> date.getFullYear() + <span class="string">'-'</span> + mouth + <span class="string">'-'</span> + day;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 这里的state的需要一个初始值，下面代码中的 setStoreItem 需要 localStorage中的 todos</span></span><br><span class="line"><span class="keyword">const</span> initState: Storestate = &#123;</span><br><span class="line">    lastUpdated: todoUtils.getStoreItem(<span class="string">"lastUpdated"</span>) || <span class="number">0</span>,</span><br><span class="line">    todos: todoUtils.getStoreItem(<span class="string">"todos"</span>) || [],</span><br><span class="line">    done: todoUtils.getStoreItem(<span class="string">"done"</span>) || [],</span><br><span class="line">    undo:todoUtils.getStoreItem(<span class="string">"undo"</span>) || []</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state = initState, action: Action</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"add todo"</span>:</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"todos"</span>, state.todos.concat(action.todo))</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                lastUpdated: <span class="built_in">Date</span>.now(),</span><br><span class="line">                todos: state.todos.concat(action.todo)</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"done todo"</span>: &#123;</span><br><span class="line">            <span class="keyword">const</span> todos = state.todos.slice()</span><br><span class="line">            <span class="keyword">let</span> doneItem: doneState = &#123;</span><br><span class="line">                content: todos.splice(action.index, <span class="number">1</span>)[<span class="number">0</span>],</span><br><span class="line">                date: getDate()</span><br><span class="line">            &#125;</span><br><span class="line">            state.done.push(doneItem)</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"todos"</span>, todos)</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"done"</span>, state.done)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                lastUpdated: <span class="built_in">Date</span>.now(),</span><br><span class="line">                todos,</span><br><span class="line">                done: state.done</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"cancel todo"</span>: &#123;</span><br><span class="line">            <span class="keyword">const</span> todos = state.todos.slice()</span><br><span class="line">            <span class="keyword">const</span> delItem = todos.splice(action.index, <span class="number">1</span>)</span><br><span class="line">            state.undo.push(delItem[<span class="number">0</span>])</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"todos"</span>, todos)</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"undo"</span>, state.undo)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                lastUpdated: <span class="built_in">Date</span>.now(),</span><br><span class="line">                todos,</span><br><span class="line">                undo: state.undo</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="keyword">case</span> <span class="string">"withdraw todo"</span>: &#123;</span><br><span class="line">            <span class="keyword">const</span> done = state.done.slice()</span><br><span class="line">            <span class="keyword">const</span> delItem = done.splice(action.index, <span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">            state.todos.push(delItem.content)</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"done"</span>, done)</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"todos"</span>, state.todos)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                lastUpdated: <span class="built_in">Date</span>.now(),</span><br><span class="line">                done,</span><br><span class="line">                todos: state.todos</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"delete todo"</span>: &#123;</span><br><span class="line">            <span class="keyword">const</span> undo = state.undo.slice()</span><br><span class="line">            undo.splice(action.index, <span class="number">1</span>)</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"undo"</span>, undo)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                lastUpdated: <span class="built_in">Date</span>.now(),</span><br><span class="line">                undo</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"restore todo"</span>: &#123;</span><br><span class="line">            <span class="keyword">const</span> undo = state.undo.slice();</span><br><span class="line">            <span class="keyword">const</span> delItem = undo.splice(action.index, <span class="number">1</span>);</span><br><span class="line">            state.todos.push(delItem[<span class="number">0</span>]);</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"undo"</span>,undo);</span><br><span class="line">            todoUtils.setStoreItem(<span class="string">"todos"</span>,state.todos);</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">              ...state,</span><br><span class="line">              lastUpdated: <span class="built_in">Date</span>.now(),</span><br><span class="line">              undo,</span><br><span class="line">              todos: state.todos</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li><code>splice</code>用法:</li>
</ul>
<blockquote>
<p>通过删除或替换现有元素或者原地添加新的元素来修改数组,并以数组形式返回被修改的内容。此方法会改变原数组。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myFish = [<span class="string">"angel"</span>, <span class="string">"clown"</span>, <span class="string">"mandarin"</span>, <span class="string">"sturgeon"</span>];</span><br><span class="line"><span class="comment">//从第 2 位开始删除 0 个元素，插入“drum”</span></span><br><span class="line"><span class="keyword">var</span> removed = myFish.splice(<span class="number">2</span>, <span class="number">0</span>, <span class="string">"drum"</span>);</span><br><span class="line"><span class="comment">//["angel", "clown", "drum", "guitar", "mandarin", "sturgeon"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//从第 3 位开始删除 1 个元素</span></span><br><span class="line"><span class="keyword">var</span> removed = myFish.splice(<span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line"><span class="comment">//["angel", "clown", "mandarin"];</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>concat</code>用法：</li>
</ul>
<blockquote>
<p>用于合并两个或多个数组。此方法不会更改现有数组，而是返回一个新数组。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    num2 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">    num3 = [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nums = num1.concat(num2, num3);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(nums); </span><br><span class="line"><span class="comment">// results in [1, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-5-utils-index-tsx"><a href="#2-5-utils-index-tsx" class="headerlink" title="2.5 utils/index.tsx"></a>2.5 <code>utils/index.tsx</code></h3><blockquote>
<p>用来放置一些需要使用的工具性函数，主要是处理数据</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> TodoUtils &#123;</span><br><span class="line">    <span class="comment">// 规定为一年有效期</span></span><br><span class="line">    <span class="keyword">public</span> storeAge: <span class="built_in">number</span> = <span class="number">366</span>*<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断本地数据是否为object，并且内容也为object的，使用toString方法可以查看出来</span></span><br><span class="line">    typeObject(o:<span class="built_in">any</span>):<span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> s = <span class="built_in">Object</span>.prototype.toString.call(o);</span><br><span class="line">        <span class="comment">// 匹配是否[object Object], 这里改成小写了</span></span><br><span class="line">        <span class="comment">// 这里会报错 对象可能为空的错误    </span></span><br><span class="line">        <span class="comment">// 解决办法：在tsconfig.ts文件中增加 --strictNullChecks，为false，则不启动对空类型的检查</span></span><br><span class="line">        <span class="keyword">return</span> s.match(<span class="regexp">/\[object (.*?)\]/</span>)[<span class="number">1</span>].toLowerCase()</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 存储本地事项</span></span><br><span class="line">    setStoreItem(key: <span class="built_in">string</span>, value: <span class="built_in">any</span>) &#123;</span><br><span class="line">        localStorage.removeItem(key)</span><br><span class="line">        <span class="keyword">let</span> isObject: <span class="built_in">boolean</span> = <span class="keyword">this</span>.typeObject(value) == <span class="string">'object'</span></span><br><span class="line">        <span class="comment">// 新添加的事项时间</span></span><br><span class="line">        <span class="keyword">const</span> _time = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">        <span class="comment">// 有效时长</span></span><br><span class="line">        <span class="keyword">const</span> _age = <span class="keyword">this</span>.storeAge;</span><br><span class="line">        <span class="comment">// 如果不是对象，新建一个对象把value存起来</span></span><br><span class="line">        <span class="keyword">if</span>(!isObject)&#123;</span><br><span class="line">            <span class="keyword">let</span> b:<span class="built_in">any</span> = value</span><br><span class="line">            value = &#123;&#125;</span><br><span class="line">            value._value = b</span><br><span class="line">        &#125;</span><br><span class="line">        value._time = _time</span><br><span class="line">        value._age = _time + _age</span><br><span class="line">        value._isObject = isObject</span><br><span class="line">        localStorage.setItem(key, <span class="built_in">JSON</span>.stringify(value))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断一个localStoreage是否过期</span></span><br><span class="line">    isExpire(key: <span class="built_in">string</span>):<span class="built_in">boolean</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> Expire:<span class="built_in">boolean</span> = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">let</span> value:<span class="built_in">any</span> = localStorage.getItem(key)</span><br><span class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">        <span class="keyword">if</span>(value) &#123;</span><br><span class="line">            value = <span class="built_in">JSON</span>.parse(value)</span><br><span class="line">            Expire = now &gt; value._age</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Expire</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取相应的事项，并转成数组</span></span><br><span class="line">    getStoreItem(key: <span class="built_in">string</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> Expire: <span class="built_in">boolean</span> = <span class="keyword">this</span>.isExpire(key)</span><br><span class="line">        <span class="keyword">let</span> value:<span class="built_in">any</span> = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">if</span>(!Expire) &#123; <span class="comment">// 如果没有过期</span></span><br><span class="line">            value = localStorage.getItem(key)</span><br><span class="line">            value = <span class="built_in">JSON</span>.parse(value)</span><br><span class="line">            <span class="keyword">if</span>(!value._isObject) &#123;</span><br><span class="line">                value = value._value</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    &#125;</span><br><span class="line">    removeStoreItem(key: <span class="built_in">string</span>) &#123;</span><br><span class="line">        localStorage.removeItem(key)</span><br><span class="line">    &#125;</span><br><span class="line">    clearStore() &#123;</span><br><span class="line">        localStorage.clear()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 这里需要new一个对象</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> todoUtils: TodoUtils = <span class="keyword">new</span> TodoUtils()</span><br></pre></td></tr></table></figure>

<h3 id="2-6-jsx的小感悟"><a href="#2-6-jsx的小感悟" class="headerlink" title="2.6 jsx的小感悟"></a>2.6 <code>jsx</code>的小感悟</h3><blockquote>
<p>jsx真的很牛逼！</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// state取出的数据为</span></span><br><span class="line">data:&#123;</span><br><span class="line">    todo:[<span class="string">'好好'</span>， <span class="string">'学习'</span>],</span><br><span class="line">    done:[</span><br><span class="line">        &#123;</span><br><span class="line">            content:<span class="string">'吃饭'</span>，</span><br><span class="line">            date:<span class="number">121212</span></span><br><span class="line">        &#125;，</span><br><span class="line">        &#123;</span><br><span class="line">        	content:<span class="string">'睡觉'</span>，</span><br><span class="line">            date:<span class="number">121212</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    undo:[<span class="string">'hh'</span>,<span class="string">'ww'</span>],</span><br><span class="line">    lastUpdated: lastUpdated</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以从state中拿数据还要处理一遍,所以还要在相应组件内使用该函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 处理 state 中的数据</span><br><span class="line">function handleState(data:any[],type:string):string&#123;</span><br><span class="line">  // item 是遍历的对象属性值</span><br><span class="line">  for(let item in data)&#123;</span><br><span class="line">    //return item</span><br><span class="line">    if(item === type &amp;&amp; type===&apos;todo&apos;)&#123;</span><br><span class="line">      return data[item]</span><br><span class="line">    &#125;else if(item===type &amp;&amp; type===&apos;done&apos;)&#123;</span><br><span class="line">      let doneList:any[]=data[item]</span><br><span class="line">      let handledoneList :any = []</span><br><span class="line">      for(let i=0; i &lt; doneList.length;i++)&#123;</span><br><span class="line">        handledoneList.push(doneList[i].content) </span><br><span class="line">      &#125;</span><br><span class="line">      return handledoneList</span><br><span class="line">    &#125;else if(item===type &amp;&amp; type===&apos;undo&apos;)&#123;</span><br><span class="line">      return data[item]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用只需要<code>{ handleState(data,type) }</code>,自动调用。</p>
<h3 id="2-7-emotion和-emotion-core是不一样的"><a href="#2-7-emotion和-emotion-core是不一样的" class="headerlink" title="2.7 emotion和 @emotion/core是不一样的"></a>2.7 <code>emotion和 @emotion/core</code>是不一样的</h3><ul>
<li>使用<code>@emotion/core</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 下面张的像注释的不能删除。删除就会报错</span><br><span class="line">/** @jsx jsx */  </span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import &#123; css,jsx &#125; from &quot;@emotion/core&quot;;</span><br><span class="line">import TodoItem from &apos;./TodoItem&apos;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用<code>emotion</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; css &#125; from &apos;emotion&apos;</span><br></pre></td></tr></table></figure>

<h2 id="3-上传github，删不了node-modules"><a href="#3-上传github，删不了node-modules" class="headerlink" title="3 .上传github，删不了node_modules"></a>3 .上传github，删不了node_modules</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install rimraf -g</span><br><span class="line">rimraf node_modules</span><br></pre></td></tr></table></figure>

<p>参考文章：</p>
<p><a href="https://segmentfault.com/q/1010000002972327" target="_blank" rel="noopener">https://segmentfault.com/q/1010000002972327</a></p>
<p><a href="https://juejin.im/post/5c81d10b5188257ee7275222" target="_blank" rel="noopener">https://juejin.im/post/5c81d10b5188257ee7275222</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/Express的学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/Express的学习/" itemprop="url">Express的学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Express/" itemprop="url" rel="index">
                    <span itemprop="name">Express</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Express学习"><a href="#Express学习" class="headerlink" title="Express学习"></a>Express学习</h1><h4 id="1-0-什么是模块化"><a href="#1-0-什么是模块化" class="headerlink" title="1.0 什么是模块化"></a>1.0 什么是模块化</h4><ul>
<li><p>文件作用域 </p>
<ul>
<li>该模块内的定义的变量只能调用当前模块的函数，其他模块有相同名字的变量也不能够调用</li>
<li>解决了模块命名冲突的问题</li>
</ul>
</li>
<li><p>通信规则</p>
<ul>
<li><p>加载 require </p>
</li>
<li><p>导出模块<code>module.exports =add</code>,add是一个方法，就能在其他模块直接使用方法。如果是<code>exports.add=add</code>，就要使用<code>.add</code>方法来使用函数，所以不推荐使用。</p>
</li>
<li><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 自定义模块 = <span class="built_in">require</span>(<span class="string">'模块'</span>)来使用模块</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>导出模块内所有函数 :<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    var add = function add(x,y)&#123;</span><br><span class="line">        return x+y</span><br><span class="line">    &#125;</span><br><span class="line">    var sun = &apos;hello&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="1-1-require-方法加载规则"><a href="#1-1-require-方法加载规则" class="headerlink" title="1.1. require 方法加载规则"></a>1.1. require 方法加载规则</h4><ul>
<li><p>核心模块</p>
<ul>
<li>模块名</li>
</ul>
</li>
<li><p>第3方模块</p>
<ul>
<li>模块名</li>
</ul>
</li>
<li><p>用户自己定义</p>
<ul>
<li>路径</li>
</ul>
</li>
<li><p>对于已经加载过的模块，不会重新加载，只是从缓存中拿到模块的加载对象，提高性能。</p>
</li>
<li><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'./foo.js'</span>)      这里的./或者../不能省略，但是后面的.js可以省略。</span><br><span class="line">fs.readFile(<span class="string">'foo.js'</span>)    在请求文件的相对路径中可以省略 ./</span><br><span class="line">fs.readFile(<span class="string">'/foo.js'</span>)   如果是 / 则是从所在文件的磁盘根目录中找</span><br></pre></td></tr></table></figure>

<p>更多底层机制参考[《深入浅出node.js》][<a href="http://www.infoq.com/cn/master-nodejs]" target="_blank" rel="noopener">http://www.infoq.com/cn/master-nodejs]</a></p>
</li>
</ul>
</li>
</ul>
<h4 id="2-0-package-json"><a href="#2-0-package-json" class="headerlink" title="2.0.package.json"></a>2.0.package.json</h4><ul>
<li><p>这就是相当于项目的说明书，根据这个文件，只要<code>npm init</code>就能生成这个文件。这里面是生成项目所需的依赖包版本号之类的信息，然后如果缺失了node_module,就可以通过<code>npm install</code>命令重新下载第3方包。</p>
</li>
<li><p>下载第 3 方包通过<code>npm install art-template --save</code>命令，要有 <code>--save</code>,这样就会保存到node_module中的依赖。在<code>npm@5</code>之后的版本可以不用加<code>--save</code></p>
</li>
<li><p>npm 升级命令：<code>npm install --global npm</code></p>
<blockquote>
<p>npm int -y 可以跳过向导，快速生成</p>
</blockquote>
</li>
<li><p>删除包</p>
<ul>
<li>删除的同时依赖信息也会删除</li>
<li><code>npm uninstall art-template --save</code>删除命令</li>
</ul>
</li>
</ul>
<h4 id="3-0-Express"><a href="#3-0-Express" class="headerlink" title="3.0.Express"></a>3.0.Express</h4><p>这里使用<code>nodemon</code>来帮我们进行伪热刷新</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">全局安装</span></span><br><span class="line">npm install --global nodemon</span><br></pre></td></tr></table></figure>

<p>安装完毕之后使用：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node app.js</span><br><span class="line"><span class="meta">#</span><span class="bash"> 改为使用 nodemon</span></span><br><span class="line">nodemon app.js</span><br></pre></td></tr></table></figure>

<h5 id="3-1-请求静态资源"><a href="#3-1-请求静态资源" class="headerlink" title="3.1.请求静态资源"></a>3.1.请求静态资源</h5><ul>
<li><p>当以 /public 为第一个参数的时候，可以通过 get 请求直接去 ./public/ 目录里面找对应的文件，也可以外联式访问，比如css,js的样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">'/public/'</span>, express.static(<span class="string">'./public/'</span>))</span><br></pre></td></tr></table></figure>
</li>
<li><p>当省略第一个参数的时候，则 get 请求需要省略 /public/</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(<span class="string">'public'</span>))</span><br></pre></td></tr></table></figure>
</li>
<li><p>推荐使用:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">//上面的功能都有</span></span><br><span class="line">app.use(<span class="string">'/public/'</span>,express.static(path.join(__dirname, <span class="string">'./public/'</span>)))</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="3-1-模板引擎"><a href="#3-1-模板引擎" class="headerlink" title="3.1.模板引擎"></a>3.1.模板引擎</h5><ul>
<li><p>Express有个约定：把所有的视图像 ejs,html,art-template  都放在 views目录之下，所以默认去 views 里面找</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.render(<span class="string">'不要加views'</span>，&#123;渲染的变量参数&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>res.render()引用模板，如果在views文件下之下的又一个文件夹(topic)，需要加上文件加路径res.render(‘topic/index.html’)</p>
</blockquote>
</li>
</ul>
<h5 id="3-1-1Path路径操作模块"><a href="#3-1-1Path路径操作模块" class="headerlink" title="3.1.1Path路径操作模块"></a>3.1.1Path路径操作模块</h5><ul>
<li>path.basename<ul>
<li>获取一个路径的文件名（默认包含扩展名）</li>
</ul>
</li>
<li>path.dirname<ul>
<li>获取一个路径的目录部分</li>
</ul>
</li>
<li>path.extname<ul>
<li>获取一个路径的扩展名部分</li>
</ul>
</li>
<li>path.parse<ul>
<li>把一个路径转化为对象</li>
<li>就是上诉几种方法的集合</li>
</ul>
</li>
</ul>
<h5 id="3-2-Express-获取表单数据"><a href="#3-2-Express-获取表单数据" class="headerlink" title="3.2.Express 获取表单数据"></a>3.2.Express 获取表单数据</h5><ul>
<li><p>获取 get 数据</p>
<ul>
<li>直接使用 <code>req.query</code> 就能获取，因为get请求直接把数据解析成字符串加在请求路径的后面，所以query 可以直接解析成json格式来使用</li>
<li>在<code>input</code>的表单中需要有<code>name</code>属性，获取的对象name作为key,所填的值作为<code>value</code>.</li>
</ul>
</li>
<li><p>获取post 数据</p>
<ul>
<li><p>使用中间件<code>body-parser</code>来获取，post 表单数据是在 form data 中，只能通过中间件来获取。</p>
</li>
<li><p>只要配置了<code>body-parser</code>就会自动在请求的属性上加入<code>body</code>属性，使用<code>req.body</code>来获取</p>
</li>
<li><p>在<code>input</code>的表单中需要有<code>name</code>属性，获取的对象name作为key,所填的值作为<code>value</code>.</p>
</li>
<li><p>配置：</p>
</li>
<li><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这两句要放在 app.use(router)之前</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>:<span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.json())</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><blockquote>
<p>在登陆注册页面中使用 ajax 时的<strong>json方法</strong></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formData = $(<span class="keyword">this</span>).serialize()</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url:<span class="string">'/register'</span>,</span><br><span class="line">    type:<span class="string">'post'</span>,</span><br><span class="line">    data:formData,</span><br><span class="line">    dataType:<span class="string">'json'</span>,<span class="comment">//这里设置的json，在后台响应数据时，不能直接res.status(200).send('ok'),因为规定了接收json数据格式，否则不会显示出来。</span></span><br><span class="line">    success:<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>就在后台响应发送数据时改成：res.status(200).json({success:true})</p>
</li>
</ul>
<h5 id="3-3-路由设计"><a href="#3-3-路由设计" class="headerlink" title="3.3 路由设计"></a>3.3 路由设计</h5><table>
<thead>
<tr>
<th>请求方法</th>
<th>请求路径</th>
<th>get参数</th>
<th align="center">post 参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>/students</td>
<td></td>
<td align="center"></td>
<td>渲染首页</td>
</tr>
<tr>
<td>GET</td>
<td>/students/new</td>
<td></td>
<td align="center"></td>
<td>渲染添加学生信息</td>
</tr>
<tr>
<td>POST</td>
<td>/students</td>
<td></td>
<td align="center">name,age,sex,hobbies</td>
<td>处理添加学生信息</td>
</tr>
<tr>
<td>GET</td>
<td>/students/edit</td>
<td>id</td>
<td align="center"></td>
<td>渲染</td>
</tr>
<tr>
<td>POST</td>
<td>/students/edit</td>
<td></td>
<td align="center">id,age,sex,hobbies,name</td>
<td>处理</td>
</tr>
<tr>
<td>GET</td>
<td>/students/delete</td>
<td>id</td>
<td align="center"></td>
<td>删除信息</td>
</tr>
</tbody></table>
<h5 id="3-4-路由请求"><a href="#3-4-路由请求" class="headerlink" title="3.4 路由请求"></a>3.4 路由请求</h5><ul>
<li>当发送 get/post 请求<strong>localhost:3000/students/edit?id=x</strong> 时，Express 会自动的向 <strong>localhost:3000/students/edit</strong> 发送数据，而不需要理会 <strong>?</strong> 之后的东西。</li>
</ul>
<h5 id="3-5-express-session-中间件"><a href="#3-5-express-session-中间件" class="headerlink" title="3.5 express-session 中间件"></a>3.5 express-session 中间件</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm i express-session</span><br><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">'express-session'</span>)</span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  secret: <span class="string">'wuxueqiang'</span>,<span class="comment">//自己设置加密字符串</span></span><br><span class="line">  resave: <span class="literal">false</span>,</span><br><span class="line">  saveUninitialized: <span class="literal">false</span> <span class="comment">//默认是 true ，表示无论是否使用 session 都会默认给一个 session 值</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>

<ul>
<li>设置与获取session</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">req.session.user = user<span class="comment">//添加 session 数据</span></span><br><span class="line">req.session.user	   <span class="comment">//获取</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>默认session 的数据是内存存储的，服务器一旦重启就会丢失，真正的生产环境要配置过的</p>
</blockquote>
<h5 id="3-6-用户头像上传-multer-中间件"><a href="#3-6-用户头像上传-multer-中间件" class="headerlink" title="3.6 用户头像上传 multer 中间件"></a>3.6 用户头像上传 multer 中间件</h5><ul>
<li><code>javascript</code>代码部分</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> multer = <span class="built_in">require</span>(<span class="string">'multer'</span>)</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dataImg = <span class="string">'public/images'</span> <span class="comment">// 头像所要存储的文件路径，是绝对路径，因为在app.js中开放了public文件夹，所以可以直接引用，images 文件夹会自动创建好</span></span><br><span class="line"><span class="keyword">var</span> storage = multer.diskStorage(&#123;</span><br><span class="line">	<span class="comment">// 如果你提供的 destination 是一个函数，你需要负责创建文件夹</span></span><br><span class="line">	destination: dataImg,</span><br><span class="line">	<span class="comment">// 给上传文件重命名，获取添加后缀名</span></span><br><span class="line">	filename: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">		cb(<span class="literal">null</span>, file.originalname)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> upload = multer(&#123;</span><br><span class="line">	storage: storage</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//	设置里面上传头像</span></span><br><span class="line"><span class="comment">//	这里的upload.single('avatar'),avatar与html里表单的 name 值相对应</span></span><br><span class="line">router.post(<span class="string">'/upload'</span>, upload.single(<span class="string">'avatar'</span>),(req, res, next) =&gt; &#123;</span><br><span class="line">	<span class="comment">/*var file = req.file</span></span><br><span class="line"><span class="comment">	console.log(file);*/</span></span><br><span class="line">	<span class="comment">//console.log(req.file)	// 打印出来的是图片的各种信息</span></span><br><span class="line">	<span class="comment">/*console.log(req.session.user)*/</span></span><br><span class="line">	<span class="comment">//	还要把文件的路径更新到用户数据中，不然的话重新登录，头像还是没有改变，但是上传的头像却在文件中</span></span><br><span class="line">    <span class="keyword">var</span> avatarUser = req.session.user</span><br><span class="line">	avatarUser.avatar = req.file.path</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*res.send(&#123;ret_code:dataImg&#125;)*/</span></span><br><span class="line">	</span><br><span class="line">	User.updateOne(&#123;<span class="attr">email</span>:avatarUser.email&#125;, &#123;<span class="attr">$set</span>:&#123;<span class="attr">avatar</span>:avatarUser.avatar&#125;&#125;,(err, result) =&gt; &#123;</span><br><span class="line">		<span class="keyword">if</span> (err) &#123;</span><br><span class="line">			<span class="keyword">return</span> res.send(<span class="string">'服务器繁忙，请稍后重试！'</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> res.redirect(<span class="string">'/profile'</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">    <span class="comment">//	更新session 信息</span></span><br><span class="line">    req.session.user = avatarUser</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>html</code>代码部分。需要注意的地方：<code>enctype=&quot;multipart/form-data&quot;</code>这段代码必填，否则 multer 不会解析</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;form id=<span class="string">"formAvatar"</span> enctype=<span class="string">"multipart/form-data"</span> action=<span class="string">"/upload"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">					&lt;span&gt;头像设置&lt;<span class="regexp">/span&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">					&#123;&#123;if user&#125;&#125;</span></span><br><span class="line"><span class="regexp">					&lt;img src="&#123;&#123; user.avatar &#125;&#125;" style="width:200px;height: 200px;background-size: cover"&gt;</span></span><br><span class="line"><span class="regexp">					&lt;p&gt;&lt;/</span>p&gt;</span><br><span class="line">					&#123;&#123; <span class="keyword">else</span> &#125;&#125;</span><br><span class="line">					&lt;img src=<span class="string">"/public/githublogo.jpg"</span>&gt;</span><br><span class="line">					&lt;p&gt;<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">					&#123;&#123; /<span class="keyword">if</span> &#125;&#125;</span><br><span class="line">					&lt;input type=<span class="string">"file"</span> name=<span class="string">"avatar"</span> value=<span class="string">"选择头像"</span> id=<span class="string">"imga"</span>&gt;</span><br><span class="line">					&lt;p&gt;<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">					&lt;input type=<span class="string">"submit"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-primary"</span> value=<span class="string">"上传头像"</span>&gt;</span><br><span class="line">				&lt;<span class="regexp">/form&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="3-7-art-template-模板的使用（由服务端渲染）"><a href="#3-7-art-template-模板的使用（由服务端渲染）" class="headerlink" title="3.7 art-template 模板的使用（由服务端渲染）"></a>3.7 art-template 模板的使用（由服务端渲染）</h5><ul>
<li><code>node.js</code>的路由方面的代码</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//	这里的数据请求，要先保存在本地变量里才行（request没有返回值，所以不要封装函数了）而且本里变量的声明为 app.locals.apiRequest = apiRequest,其它方式的声明无效（var apiRequest = []）</span></span><br><span class="line"><span class="keyword">var</span> apiRequest = []</span><br><span class="line">app.locals.apiRequest = apiRequest</span><br><span class="line"><span class="comment">//	render 直接开放了 views 文件夹，所以渲染只要直接引用里面的文件夹就行</span></span><br><span class="line">router.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">	<span class="comment">/*console.log(req.session.user)*/</span></span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'woshisb'</span>)</span><br><span class="line">	<span class="comment">//	动态渲染数据</span></span><br><span class="line">	request.get(<span class="string">'https://www.v2ex.com/api/topics/latest.json'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error, response, body</span>) </span>&#123;</span><br><span class="line">		    <span class="keyword">if</span> (!error &amp;&amp; response.statusCode == <span class="number">200</span>) &#123;</span><br><span class="line">		        <span class="comment">//console.log(body)</span></span><br><span class="line">		        apiRequest = <span class="built_in">JSON</span>.parse(body); <span class="comment">// 输出请求到的body</span></span><br><span class="line">		</span><br><span class="line">		    &#125;</span><br><span class="line">		&#125;)</span><br><span class="line">	res.render(<span class="string">'_layouts/home.html'</span>, &#123;</span><br><span class="line">		user:req.session.user,</span><br><span class="line">		information: apiRequest</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>前端的代码（数组遍历的使用要根据 json 的数据格式来）</li>
</ul>
<p><img src="D:%5CTypora%5CExpress%E5%AD%A6%E4%B9%A0%5Cjson.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//  只需要在外围进行一次遍历就行（看数据的数组位置）</span><br><span class="line">&#123;&#123; each information as value &#125;&#125;</span><br><span class="line">				<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">"48"</span> <span class="attr">valign</span>=<span class="string">"top"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span>	 </span><br><span class="line">						<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; value.member.url &#125;&#125;"</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; value.member.avatar_normal &#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"avatar"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">align</span>=<span class="string">"defualt"</span> <span class="attr">style</span>=<span class="string">"margin-top: 10px;background-size: cover;"</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">each</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="3-8-art-template-由客户端渲染"><a href="#3-8-art-template-由客户端渲染" class="headerlink" title="3.8 art-template 由客户端渲染"></a>3.8 art-template 由客户端渲染</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>模板<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"art-template.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">type</span>=<span class="string">"text/html"</span>&gt;</span></span><br><span class="line"><span class="handlebars"><span class="xml">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><span class="template-variable">&#123;&#123; title &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">//	渲染的数据一定要是 JSON 的数据格式，否则渲染不出来</span></span></span><br><span class="line"><span class="actionscript">	<span class="keyword">var</span> data = &#123;</span></span><br><span class="line"><span class="actionscript">		title:<span class="string">'基本粒子'</span></span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="actionscript">	<span class="keyword">var</span> html = template(<span class="string">'test'</span>, data)</span></span><br><span class="line"><span class="javascript">	<span class="built_in">document</span>.getElementById(<span class="string">'app'</span>).innerHTML = html</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="3-9-由客户端渲染（ajax请求数据）"><a href="#3-9-由客户端渲染（ajax请求数据）" class="headerlink" title="3.9 由客户端渲染（ajax请求数据）"></a>3.9 由客户端渲染（ajax请求数据）</h5><p><img src="D:%5CTypora%5CExpress%E5%AD%A6%E4%B9%A0%5Cajax%E7%9A%84json.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">type</span>=<span class="string">"text/html"</span>&gt;</span>	</span><br><span class="line"><span class="actionscript">	&#123;&#123;code&#125;&#125;                        <span class="comment">//拿到的应该是第一个大括号里的东西  200</span></span></span><br><span class="line"><span class="actionscript">	&#123;&#123;<span class="keyword">each</span> result value index&#125;&#125;   	<span class="comment">//  循环的应该是第一个大括号里的数组	</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><span class="template-variable">&#123;&#123;value.name&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span></span><br><span class="line"><span class="actionscript">	&#123;&#123;<span class="keyword">each</span> value.content value index&#125;&#125;  <span class="comment">//这里的数组是 result 数组之下的</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><span class="template-variable">&#123;&#123;value.author&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">	</span><span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">each</span></span>&#125;&#125;</span><span class="xml"></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">	</span><span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">each</span></span>&#125;&#125;</span><span class="xml"></span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	<span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">		$.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">			url:<span class="string">'http://api.apiopen.top/musicRankings'</span>,</span></span><br><span class="line"><span class="actionscript">			type:<span class="string">'GET'</span>,</span></span><br><span class="line"><span class="actionscript">			dataType:<span class="string">'json'</span>,</span></span><br><span class="line"><span class="actionscript">			success:<span class="function"><span class="keyword">function</span> <span class="params">(msg)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">				$(<span class="string">'#app'</span>).html(template(<span class="string">"test"</span>,msg));	</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-0-回调函数"><a href="#4-0-回调函数" class="headerlink" title="4.0 回调函数"></a>4.0 回调函数</h4><ul>
<li>node 的核心就是回调函数，通过回调函数来提高性能。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//暴露出函数</span></span><br><span class="line"><span class="comment">//这里的参数 callback 就是下面的回调函数 </span></span><br><span class="line">exports.find = <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>) </span>&#123;</span><br><span class="line">	fs.readFile(dbPath, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (err) &#123;</span><br><span class="line">			<span class="comment">//需要让 err 被调用，就要使用回调函数 </span></span><br><span class="line">            <span class="comment">//如果直接 return err 就是在返回在readFile的函数中，因为当前的函数作用域在readFile中</span></span><br><span class="line">            <span class="keyword">return</span> callback(err)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//在这里传参数，没有错误则传第一个参数为空</span></span><br><span class="line">        callback(<span class="literal">null</span>, <span class="built_in">JSON</span>.parse(data).students)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//students 就是代表的学生信息</span></span><br><span class="line">Student.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, students</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (err) &#123;</span><br><span class="line">			<span class="keyword">return</span> res.status(<span class="number">500</span>).send(<span class="string">'Server error'</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		res.render(<span class="string">'index.html'</span>, &#123;</span><br><span class="line">			fruits:[</span><br><span class="line">				<span class="string">'苹果'</span>,</span><br><span class="line">				<span class="string">'香蕉'</span>,</span><br><span class="line">				<span class="string">'橘子'</span></span><br><span class="line">			],</span><br><span class="line">			students:students</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>例子</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'1'</span>)</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> sum = x + y</span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'2'</span>)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'3'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(add(<span class="number">10</span>,<span class="number">30</span>)) <span class="comment">// undefined</span></span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//3</span></span><br><span class="line"><span class="comment">//undefined</span></span><br><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="comment">// 因为 js 的机制就是遇见定时器的话，会优先执行后面的代码，然后再调用定时器里的函数</span></span><br></pre></td></tr></table></figure>

<ul>
<li>解决办法：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y, callback</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'1'</span>)</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> sum = x + y</span><br><span class="line">        callback(sum)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">10</span>, <span class="number">20</span>, <span class="function"><span class="keyword">function</span>(<span class="params">sum</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(sum)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="5-0-MongoDB"><a href="#5-0-MongoDB" class="headerlink" title="5.0 MongoDB"></a>5.0 MongoDB</h4><ul>
<li><p>下载之后需要配置环境变量</p>
</li>
<li><p>启动数据库</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net start mongodb</span><br></pre></td></tr></table></figure>

<ul>
<li>连接数据库</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo  这样就行</span><br></pre></td></tr></table></figure>

<h5 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> show dbs		//查看mongodb的数据库</span></span><br><span class="line">local 0.000GB</span><br><span class="line">test 0.0000GB</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> use <span class="built_in">test</span> 		//选择数据库（如果没有就会创建一个数据库）并且变成在当前数据库</span></span><br><span class="line">switched to db test</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">show tables	//查看数据库下的表</span></span><br><span class="line">users</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">db.users.find()	//没有限定查询条件就会全部输出</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>更多命令:<a href="https://www.jianshu.com/p/e34489d0c7c7" target="_blank" rel="noopener">mongodb基础命令</a></p>
<p>Mongodb基本使用：<a href="https://www.cnblogs.com/TankMa/archive/2011/06/08/2074947.html" target="_blank" rel="noopener">命令</a></p>
</blockquote>
<h4 id="5-1-node-js-操作mongodb的常用操作"><a href="#5-1-node-js-操作mongodb的常用操作" class="headerlink" title="5.1 node.js 操作mongodb的常用操作"></a>5.1 node.js 操作mongodb的常用操作</h4><ul>
<li>添加数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">'/profile'</span>,(req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> data = [&#123;<span class="string">"naem"</span>:<span class="string">"wuxueqiang"</span>,<span class="string">"age"</span>:<span class="number">21</span>&#125;,&#123;<span class="string">"naem"</span>:<span class="string">'lihua'</span>,<span class="string">"age"</span>:<span class="number">22</span>&#125;]</span><br><span class="line">    User.insert(data,(err, data) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.status(<span class="number">500</span>).json(&#123;   <span class="comment">// 这里的json数据与前台的页面相结合，前台ajax的success可以接受到这里返回的数据</span></span><br><span class="line">                err_code:<span class="number">1</span>,</span><br><span class="line">                message:<span class="string">'数据提交错误！'</span></span><br><span class="line">            &#125;) </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.status(<span class="number">200</span>).json(&#123;</span><br><span class="line">                err_code:<span class="number">0</span>,</span><br><span class="line">                message:<span class="string">'数据提交成功'</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>查询操作</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">'/register'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">	<span class="comment">//1.0 获取表单提交的数据</span></span><br><span class="line">	<span class="comment">//2.0 操作数据库</span></span><br><span class="line">	<span class="comment">//	   判断用户是否已存在</span></span><br><span class="line">	<span class="comment">//	   如果已存在 不能注册</span></span><br><span class="line">	<span class="comment">//	   如果不存在，注册新用户</span></span><br><span class="line">	<span class="comment">//3.0 发送响应</span></span><br><span class="line">	<span class="comment">/*console.log(req.body)*/</span></span><br><span class="line">	<span class="keyword">var</span> body = req.body</span><br><span class="line">	body.password = md5(md5(body.password))</span><br><span class="line">	<span class="comment">/*console.log(body.password)*/</span></span><br><span class="line">	User.findOne(&#123;</span><br><span class="line">		$or:[</span><br><span class="line">			&#123;</span><br><span class="line">				email:body.email</span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				nickname:body.nickname</span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">		</span><br><span class="line">	&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (err) &#123;</span><br><span class="line">			<span class="keyword">return</span> res.status(<span class="number">500</span>).json(&#123;</span><br><span class="line">				err_code:<span class="number">500</span>,</span><br><span class="line">				message:<span class="string">'服务端错误'</span></span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (data) &#123;</span><br><span class="line">			<span class="keyword">return</span> res.status(<span class="number">200</span>).json(&#123;</span><br><span class="line">				err_code:<span class="number">1</span>,</span><br><span class="line">				message:<span class="string">'邮箱或者昵称已存在'</span></span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//	保存数据</span></span><br><span class="line">		<span class="keyword">new</span> User(body).save(<span class="function"><span class="keyword">function</span>(<span class="params">err, user</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">if</span> (err) &#123;</span><br><span class="line">				<span class="keyword">return</span> res.status(<span class="number">500</span>).json(&#123;</span><br><span class="line">					err_code:<span class="number">500</span>,</span><br><span class="line">					message:<span class="string">'服务端错误'</span></span><br><span class="line">				&#125;)</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// 	注册成功，使用 Session 记录用户的登录状态</span></span><br><span class="line">			req.session.user = user;</span><br><span class="line">			</span><br><span class="line">			res.status(<span class="number">200</span>).json(&#123;</span><br><span class="line">				err_code:<span class="number">0</span>,</span><br><span class="line">				message:<span class="string">'ok'</span></span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">		</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>删除操作</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> whereStr = &#123;<span class="string">"name"</span>: <span class="string">'wuxueqiang'</span>&#125;</span><br><span class="line">User.remove(whereStr, (err, result) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">'Error:'</span>+ err)</span><br><span class="line">        retrun;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>更新数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//	里面填写需要更新的数据</span></span><br><span class="line">User.updateOne(&#123;<span class="attr">email</span>: userEmail&#125;, &#123;<span class="attr">$set</span>:&#123;<span class="attr">nickname</span>: newUser.nickname, <span class="attr">bio</span>: newUser.bio, <span class="attr">gender</span>: newUser.gender&#125;&#125;, (err, result) =&gt; &#123;</span><br><span class="line">		<span class="keyword">if</span> (err) &#123;</span><br><span class="line">			<span class="keyword">return</span> res.status(<span class="number">500</span>).json(&#123;</span><br><span class="line">				err_code:<span class="number">1</span>,</span><br><span class="line">				message:<span class="string">'数据提交错误'</span></span><br><span class="line">			&#125;)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> res.status(<span class="number">200</span>).json(&#123;</span><br><span class="line">				err_code:<span class="number">200</span>,</span><br><span class="line">				message:<span class="string">'数据提交成功！'</span></span><br><span class="line">			&#125;)</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//	更新完用户数据，session也同时更新</span></span><br><span class="line">	req.session.user = newUser</span><br></pre></td></tr></table></figure>

<h4 id="6-0-Promise"><a href="#6-0-Promise" class="headerlink" title="6.0 Promise"></a>6.0 Promise</h4><ul>
<li>封装一个<code>readFile</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">preadFile</span>(<span class="params">filePath</span>) </span>&#123;</span><br><span class="line">	<span class="comment">//resolve 表示已完成，reject 表示出错并停止运行</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">		fs.readFile(filePath, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">if</span> (err) &#123;</span><br><span class="line">				reject(err)</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				resolve(data)</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">preadFile(<span class="string">'./data/a.txt'</span>)</span><br><span class="line">	<span class="comment">//这里的data 为preadFile 的返回数据</span></span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(data)</span><br><span class="line">		<span class="comment">//这里返回的数据被下面的 function 接收</span></span><br><span class="line">    	<span class="keyword">return</span> preadFile(<span class="string">'./data/b.txt'</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	.then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(data)</span><br><span class="line">		<span class="keyword">return</span> preadFile(<span class="string">'./data/c.txt'</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	.then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(data)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="6-1-Events-模块"><a href="#6-1-Events-模块" class="headerlink" title="6.1 Events 模块"></a>6.1 Events 模块</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line"><span class="keyword">var</span> EventEmitter = <span class="keyword">new</span> events.EventEmiter()</span><br><span class="line"><span class="comment">//  绑定to_parent 的事件</span></span><br><span class="line">EventEmitter.on(<span class="string">'to_parent'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//	处理 to_parent 事件</span></span><br><span class="line">    EventEmitter.emit(<span class="string">'to_parent'</span>,<span class="string">'发送的数据'</span>)</span><br><span class="line">&#125;,<span class="number">2000</span>)</span><br><span class="line">events.emiter.listenerCount(eventName) <span class="comment">//  返回指定事件的监听器数量</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果你在同一个事件上添加的监听器超过10个就会引发警告，需要<code>setMaxListeners(n)</code>来提高默认限制数量</p>
</blockquote>
<ul>
<li>大多数时候我们不会直接使用 EventEmitter，而是在对象中继承它。包括 fs、net、 http 在内的，只要是支持事件响应的核心模块都是 EventEmitter 的子类。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/linux文件目录的学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/linux文件目录的学习/" itemprop="url">linux文件目录的学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="关于文件目录的学习"><a href="#关于文件目录的学习" class="headerlink" title="关于文件目录的学习"></a>关于文件目录的学习</h1><h2 id="1-0-复制移动删除文件操作"><a href="#1-0-复制移动删除文件操作" class="headerlink" title="1.0 复制移动删除文件操作"></a>1.0 复制移动删除文件操作</h2><ul>
<li><p><code>cp</code>用于复制一个或多个文件或目录。</p>
</li>
<li><p><code>mv</code>用于<em>移动</em> 或<em>重命名</em> 一个或多个文件或目录。</p>
</li>
<li><p><code>rm</code>用于<em>删除</em> 一个或多个文件</p>
</li>
</ul>
<p><code>rm -rf</code>是删除目录所有文件，不带<code>-rf</code>则只是删除文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cp 来源文件 目标文件</span></span><br><span class="line">cp text1 text2	<span class="comment"># 在当前的文件下，复制text1,名字为text2的文件到当前文件下</span></span><br><span class="line">cp text1 ../backup/text33 <span class="comment">#复制当前文件下的text1，到相邻文件下且命名为text33</span></span><br><span class="line">mv text1 text2 <span class="comment"># 重命名text1为text2</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>touch</code>是创建文件，<code>mkdir</code>是创建目录</p>
</blockquote>
<ul>
<li><code>mkdir -p d1/d2/d3</code>加了参数 -p 则会d1,d2,d3 都会创建</li>
</ul>
<h2 id="2-0-改变文件所属和权限"><a href="#2-0-改变文件所属和权限" class="headerlink" title="2.0 改变文件所属和权限"></a>2.0 改变文件所属和权限</h2><ul>
<li><code>chgrp</code> 改变文件所属群组: </li>
<li><code>chown</code>改变文件拥有者</li>
<li><code>chmod</code>改变文件的权限</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法：chown [-R] 用户 文件或目录 参数R表示递归</span></span><br><span class="line"><span class="comment"># 	   chown [-R] 用户:群组 文件或目录</span></span><br><span class="line">chown bin text1 <span class="comment"># 将text1的拥有着改为bin</span></span><br><span class="line">chown root:user text1 <span class="comment"># 将text1的使用者改为root，群组改为user</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-数字类型改变文件权限"><a href="#2-1-数字类型改变文件权限" class="headerlink" title="2.1 数字类型改变文件权限"></a>2.1 数字类型改变文件权限</h3><p><code>ls -l</code>可以查看文件或目录的权限相关信息</p>
<blockquote>
<p>r:4   w:2 x:1 </p>
</blockquote>
<p>每种身份(owner/group/others)各自的三个权限(r/w/x)分数是需要累加的：</p>
<p><strong>owner = rwx = 4+2+1=7</strong></p>
<p><strong>group = rwx = 4+2+1=7</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chmod a+w 文件名 在原有权限上加入写入权限 -w 则收回写入权限</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>user(u)</code>:具有可读可写，可执行的权限</li>
<li><code>group与others(g/o)</code>:具有可读与执行的权限</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod u=rwx,g=rwx,o=rwx text1</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果一个用户只有r–权限，那么他只有运行<code>ls</code>的功能，但是因为没有<code>x</code>权限，所以他不能进入这个目录</p>
</blockquote>
<h2 id="3-0-文件相关的含义"><a href="#3-0-文件相关的含义" class="headerlink" title="3.0 文件相关的含义"></a>3.0 文件相关的含义</h2><ul>
<li><code>/(root,根目录)</code>:与开机系统有关</li>
<li><code>/usr</code>：与软件安装/执行有关，所以<code>/usr/local</code>一般用户自己安装的软件都放在<code>local目录下</code></li>
<li><code>/var</code>: 与系统运作过程有关</li>
<li><code>/home</code>：这是系统默认的用户家目录(home directory)。在你新增一个一般使用者账号时， 默认的用户家目录都在这里。一般每个用户分配一个目录</li>
<li><code>/etc</code>:配置文件所在</li>
</ul>
<h3 id="3-1-压缩解压缩命令"><a href="#3-1-压缩解压缩命令" class="headerlink" title="3.1 压缩解压缩命令"></a>3.1 压缩解压缩命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#压缩</span></span><br><span class="line">tar -czvf ***.tar.gz</span><br><span class="line">tar -cjvf ***.tar.bz2</span><br><span class="line"><span class="comment">#解压缩</span></span><br><span class="line">tar -xzvf ***.tar.gz</span><br><span class="line">tar -xjvf ***.tar.bz2</span><br></pre></td></tr></table></figure>

<p>参数解释：</p>
<ul>
<li><code>-c</code>：建立一个压缩档案的参数指令</li>
<li><code>-x</code>:  解开一个压缩档案的参数指令！</li>
<li><code>-z</code>：进行<code>gzip</code>压缩</li>
<li><code>-j</code>：进行<code>bzip2</code>压缩</li>
<li><code>-v</code>： 显示压缩/解压缩进程</li>
<li><code>-f</code>：f之后要接目录名字（打包压缩是接目标目录，解压是接源包）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打包语法：tar -czvf 目标目录 源文件</span></span><br><span class="line">tar -cvf /tmp/etc.tar /etc  &lt;==仅打包，不压缩</span><br><span class="line">tar -czvf /tmp/etc.tar.gz /etc  &lt;==打包后，以 gzip 压缩</span><br><span class="line">tar -cjvf /tmp/etc.tar.bz2 /etc  &lt;==打包后，以 bzip2 压缩</span><br></pre></td></tr></table></figure>

<ul>
<li>解压文件到指定的目录</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar -zxvf 源包 目标目录 </span></span><br><span class="line">tar -zxvf .tar.gz -C /home/aaa</span><br></pre></td></tr></table></figure>

<ul>
<li>前端必知linux知识：<a href="https://segmentfault.com/a/1190000010421178（scp传文件）" target="_blank" rel="noopener">https://segmentfault.com/a/1190000010421178（scp传文件）</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/sublime-text3安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/sublime-text3安装/" itemprop="url">sublime-text3安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/安装/" itemprop="url" rel="index">
                    <span itemprop="name">安装</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-0-sublime-text3安装"><a href="#1-0-sublime-text3安装" class="headerlink" title="1.0 sublime-text3安装"></a>1.0 sublime-text3安装</h1><ul>
<li>下载<code>sublime-text3</code>，一路安装，不断<code>next</code>就行</li>
</ul>
<p><strong>安装插件肯定会报错，因为sublime-text3启动了ivp6或者是因为墙的原因</strong></p>
<blockquote>
<p>这是我分享的Package Control.sublime-package文件</p>
<p>链接：<a href="https://pan.baidu.com/s/1tyfJaEJ-Z_YE-3HhbPfh2w" target="_blank" rel="noopener">https://pan.baidu.com/s/1tyfJaEJ-Z_YE-3HhbPfh2w</a><br>提取码：y97u </p>
</blockquote>
<p>需要先下载这份文件，然后打开<code>sublime-text3</code></p>
<blockquote>
<p>依次点击<code>Preferences</code> &gt; <code>browser Packages</code>，会打开文件夹，然后打开上一层文件夹的<code>installed Packages</code></p>
</blockquote>
<p>将下载的<code>Package Control.sublime-package</code>复制进去，然后查看<code>Preferences</code>会有<code>package control</code>选项，证明这一步没错。</p>
<ul>
<li>更改下载插件地址</li>
</ul>
<blockquote>
<p>安装插件错误是因为<code>channel_v3.json</code>文件的地址不在墙内，所以我们需要使用国内的地址</p>
</blockquote>
<p><code>Preferences</code> &gt; <code>Package Settings</code> &gt; <code>Package Control</code> &gt; <code>Settings - User</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"channels":</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"http://static.bolin.site/channel_v3.json"</span>,</span><br><span class="line">        //<span class="string">"https://packagecontrol.io/channel_v3.json"</span>, 把这里的注释掉，使用上面的地址</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果修改的<code>channel_v3.json</code>的地址还是有错误，那么就可能是该<code>json</code>文件没有更新，需要自行寻找新的<code>json</code>文件配置。</p>
</blockquote>
<h2 id="2-0-配置go环境"><a href="#2-0-配置go环境" class="headerlink" title="2.0 配置go环境"></a>2.0 配置<code>go</code>环境</h2><blockquote>
<p>现在的<code>GoSublime</code>已经不支持直接在sublime-text3 上直接安装了，所以我们只能手动安装</p>
</blockquote>
<p><strong>手动安装：</strong><a href="https://blog.csdn.net/u011677067/article/details/84069730" target="_blank" rel="noopener">https://blog.csdn.net/u011677067/article/details/84069730</a></p>
<p>安装完就可以使用了，前提是你先把<code>go</code>的环境配好了，编译运行就直接在终端运行吧。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/ubuntu部署ghost博客/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/ubuntu部署ghost博客/" itemprop="url">ubuntu部署ghost博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/博客/" itemprop="url" rel="index">
                    <span itemprop="name">博客</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>前言</strong>：想要建立ghost博客的应该都有了自己服务器，才到这一步的。所以还需要一些准备工作：</p>
<ul>
<li><code>mysql</code>的安装版本要小于8.0的，一般都是5.7</li>
<li><code>node</code>的安装可以通过<code>nvm</code>安装（最好不要在root用户下安装，因为ghost的安装不能使用<code>root</code>用户，但是如果你是在root用户安装的node的话，在非root用户的权限下是不能使用node的，而且还需要重新安装。这里涉及到了linux的用户权限和其文件系统的原理，就不扯了。）所以我们最好新建一个用户来进行操作，一般都不使用root用户。</li>
<li><em>mysql和node的安装可以参考我的上一篇博客《部署nodejs项目到ubuntu云服务器上》，有所提及，希望对各位小伙伴有帮助</em></li>
</ul>
<h2 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h2><ul>
<li>安装nginx需要在root用户下</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nginx</span><br></pre></td></tr></table></figure>

<ul>
<li>调整防火墙</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw allow <span class="string">'Nginx Full'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>验证Nginx是否正常工作</li>
</ul>
<p>只要能通过外网访问你的<code>IP</code>地址就行，应该会显示nginx的信息。</p>
<ul>
<li>参考博客：<a href="https://juejin.im/post/59eaf94151882521f2435c43" target="_blank" rel="noopener">https://juejin.im/post/59eaf94151882521f2435c43</a></li>
</ul>
<h2 id="安装ghost"><a href="#安装ghost" class="headerlink" title="安装ghost"></a>安装ghost</h2><ul>
<li>安装<code>ghost-cli</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install ghost-cli@latest -g</span><br></pre></td></tr></table></figure>

<ul>
<li>创建文件夹</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /var/www/ghost</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将文件夹赋予用户 username  就是你的用户名字</span></span><br><span class="line">sudo chown username:userame /var/www/ghost</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开放权限</span></span><br><span class="line">sudo chmod 775 /var/www/ghost</span><br><span class="line"></span><br><span class="line"><span class="comment"># Then navigate into it</span></span><br><span class="line"><span class="built_in">cd</span> /var/www/ghost</span><br><span class="line"></span><br><span class="line">ghost install</span><br></pre></td></tr></table></figure>

<ul>
<li>开始安装的时候会有一些设置：</li>
</ul>
<p><img src="D:%5CTypora%5Clinux%E5%AD%A6%E4%B9%A0%5Cghost.jpg" alt></p>
<p><code>url</code>的地址就是你的<code>IP</code>地址,还会有<code>nginx</code>的设置之类，看你自己的需求吧</p>
<ul>
<li>官网有<a href="https://docs.ghost.org/install/ubuntu/" target="_blank" rel="noopener">详细配置</a></li>
</ul>
<h2 id="最后的配置"><a href="#最后的配置" class="headerlink" title="最后的配置"></a>最后的配置</h2><p>在进行到这一步后，你会发现还是不能通过<code>IP+:2068</code>访问，接下来就是解决办法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/ghost</span><br><span class="line"><span class="comment"># ls命令后你会看到一个配置文件 config.production.json</span></span><br><span class="line">ls</span><br><span class="line"><span class="comment"># 修改配置文件</span></span><br><span class="line">sudo vim config.production.json</span><br><span class="line"><span class="comment"># 配置内容</span></span><br><span class="line"><span class="string">"server"</span>: &#123;</span><br><span class="line">    <span class="string">"port"</span>: 2368,</span><br><span class="line">    <span class="string">"host"</span>: <span class="string">"0.0.0.0"</span>  <span class="comment"># 将这里的127.0.0.1改成0.0.0.0</span></span><br><span class="line">  &#125;,</span><br><span class="line"><span class="comment"># 配置完成保存退出，然后通过IP+:+2368端口就可以访问了</span></span><br></pre></td></tr></table></figure>

<p>那么Nginx是什么作用呢？它提供一个映射端口的功能。比如你访问101.132.106.94就可以映射到101.132.106.94：2368</p>
<ul>
<li>修改Nginx的配置文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置文件应该在/etc/nginx目录下</span></span><br><span class="line"><span class="built_in">cd</span> /etc/nginx</span><br><span class="line">sudo vim nginx.conf</span><br><span class="line"><span class="comment"># 先在第一行的user www.data; 改成 user root;</span></span><br><span class="line"><span class="comment"># 然后在http模块里面进行配置</span></span><br><span class="line">http &#123;</span><br><span class="line">        <span class="comment">#ghost端口设置</span></span><br><span class="line">        server &#123;</span><br><span class="line">                listen 80;</span><br><span class="line">                server_name 101.132.104.94;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_set_header   X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">                proxy_set_header   Host  <span class="variable">$http_host</span>;</span><br><span class="line">                proxy_pass http://127.0.0.1:2368;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 重新启动</span></span><br><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure>

<p>我们并不需要进行持久化操作，ghost好像默认持久化的。然后就可以通过IP地址访问了</p>
<h2 id="最最后面的配置"><a href="#最最后面的配置" class="headerlink" title="最最后面的配置"></a>最最后面的配置</h2><blockquote>
<p>如果你想要邀请别人进入你的团队的话，需要在阿里云的控制台开启<code>smtp</code>服务</p>
</blockquote>
<ul>
<li>开启<code>SMTP</code>服务</li>
</ul>
<p>参考：<a href="https://ninghao.net/video/3634" target="_blank" rel="noopener">https://ninghao.net/video/3634</a></p>
<ul>
<li>修改<code>ghost</code>的配置文件，修改程序根目录的<code>config.production.json</code>文件</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"mail"</span>: &#123;</span><br><span class="line">    <span class="string">"transport"</span>: <span class="string">"SMTP"</span>,</span><br><span class="line">    <span class="string">"from"</span>: <span class="string">"'xiaowu' &lt;123456@qq.com&gt;"</span>,</span><br><span class="line">    <span class="string">"options"</span>: &#123;</span><br><span class="line">        <span class="string">"host"</span>: <span class="string">"smtp.qq.com"</span>,</span><br><span class="line">        <span class="string">"secureConnection"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"port"</span>: <span class="number">465</span>,</span><br><span class="line">        <span class="string">"auth"</span>: &#123;</span><br><span class="line">            <span class="string">"user"</span>: <span class="string">"123456@qq.com"</span>,</span><br><span class="line">            <span class="string">"pass"</span>: <span class="string">"qq邮箱授权码"</span> <span class="comment">// 需要获取授权码</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>获取qq邮箱授权码</li>
</ul>
<p>参考：<a href="https://blog.csdn.net/github_2011/article/details/82664560" target="_blank" rel="noopener">https://blog.csdn.net/github_2011/article/details/82664560</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/win10下使用nvm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/win10下使用nvm/" itemprop="url">win10下使用nvm</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/安装/" itemprop="url" rel="index">
                    <span itemprop="name">安装</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="win10下使用nvm"><a href="#win10下使用nvm" class="headerlink" title="win10下使用nvm"></a>win10下使用nvm</h1><ul>
<li>先把原来安装的<code>nodejs</code>给卸载了，原来的node安装包都可以删除掉</li>
<li>找到<a href="https://github.com/coreybutler/nvm-windows/releases" target="_blank" rel="noopener">nvm-windows</a>的网站,下载<code>nvm-setup.zip</code>包，解压之后<strong>使用管理员权限安装</strong>，不然会报错。就可以使用<code>nvm</code>的命令来安装nodejs了。</li>
<li>第一次提示安装位置：<code>D:\nvm</code>（这是<code>nvm</code>的安装位置）</li>
<li>第二次提示安装位置：<code>D:\nodejs</code>   (这是<code>nodejs</code>的安装位置)</li>
</ul>
<h2 id="1-0-配置npm的淘宝镜像源"><a href="#1-0-配置npm的淘宝镜像源" class="headerlink" title="1.0 配置npm的淘宝镜像源"></a>1.0 配置<code>npm</code>的淘宝镜像源</h2><p>找到nvm的安装地址，比如我的是<code>D:\nvm\nvm</code>,在这个文件加下可以看到<code>settings.text</code>文件，打开进行配置。<strong>加入以下两行</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node_mirror: https:<span class="comment">//npm.taobao.org/mirrors/node/</span></span><br><span class="line">npm_mirror: https:<span class="comment">//npm.taobao.org/mirrors/npm/</span></span><br></pre></td></tr></table></figure>

<h2 id="2-0-安装nodejs"><a href="#2-0-安装nodejs" class="headerlink" title="2.0 安装nodejs"></a>2.0 安装<code>nodejs</code></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm install 8.12.0 #下载安装8.12.0版本的nodejs</span><br><span class="line">nvm use 8.12.0	   # 使用8.12.0 版本的nodejs</span><br></pre></td></tr></table></figure>

<h2 id="3-0-配置环境变量"><a href="#3-0-配置环境变量" class="headerlink" title="3.0 配置环境变量"></a>3.0 配置环境变量</h2><blockquote>
<p>许多教程是要你自己配置<code>NVM_HOME</code>和<code>NVM_SYMLINK</code>,还要再PATH里面配置<code>%NVM_HOME%</code>和<code>NVM_SYMLINK</code>,其实这些都不需要配置的，nvm 1.1.7 已经帮你配好了。</p>
</blockquote>
<p>打开<code>nodejs</code>的安装位置，即<code>D:\nodejs</code>里面可以看到<code>npm-global</code>文件夹，这是放置全局命令的地方。</p>
<p>所以要将<code>D:\nodejs\npm-global</code>添加到系统<code>PATH</code>中。</p>
<p>新建一个系统变量：<code>NODE_PATH</code>，再将<code>D:\nodejs\npm-global\node_modules</code>加入其中。意为告诉系统  用户下载的全局变量自此处</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install yarn -g # 没有配置环境变量，可以安装全局命令但是无法调用。</span><br><span class="line">yarn -v # 如果没有配置环境变量会出现“找不到命令的错误”。</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/webpack配置和React/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/webpack配置和React/" itemprop="url">webpack配置和React</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/reactjs/" itemprop="url" rel="index">
                    <span itemprop="name">reactjs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-0-webpack配置和React"><a href="#1-0-webpack配置和React" class="headerlink" title="1.0 webpack配置和React"></a>1.0 webpack配置和React</h1><p>参考这篇文章<strong><a href="https://juejin.im/post/5afc29fa6fb9a07ab379a2ae" target="_blank" rel="noopener">https://juejin.im/post/5afc29fa6fb9a07ab379a2ae</a></strong></p>
<blockquote>
<p>但是有一个错误，就是在webpack.base.conf.js 中 <code>plugins</code> 的<code>new CleanWebpackPlugin()</code></p>
<p>还需要安装<code>bable-core</code>,而且<code>babel-loader</code>需要使用7.0版本，看报错安装就行。</p>
</blockquote>
<ul>
<li>在项目文件夹下新建<code>webpack.base.conf.js</code>,表示最基本的配置文件</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> CleanWebpackPlugin = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>, <span class="comment">// 入口文件</span></span><br><span class="line">    output: &#123; <span class="comment">// 出口文件</span></span><br><span class="line">        filename: <span class="string">'bundle.[hash].js'</span>,</span><br><span class="line">        path: path.join(__dirname, <span class="string">'/dist'</span>) <span class="comment">// 打包到当前根目录下dist文件夹下</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] <span class="comment">// 表示匹配到css文件时，使用这2种先编译再打包</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">              use: <span class="string">'babel-loader'</span>,</span><br><span class="line">              exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">'./src/index.html'</span> <span class="comment">// 网站的入口html文件</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="2-0-sublime-text-和vscode配置reactjs的开发环境"><a href="#2-0-sublime-text-和vscode配置reactjs的开发环境" class="headerlink" title="2.0 sublime-text 和vscode配置reactjs的开发环境"></a>2.0 sublime-text 和vscode配置reactjs的开发环境</h2><p><code>vscode</code>:<a href="https://blog.csdn.net/shaleilei/article/details/82984228" target="_blank" rel="noopener">https://blog.csdn.net/shaleilei/article/details/82984228</a></p>
<p><code>sublime-text</code>:<a href="http://blog.hooperui.com/%E5%9C%A8sublime-text3%E4%B8%8A%E6%90%AD%E5%BB%BA%E9%80%82%E5%90%88react%E5%BC%80%E5%8F%91%E7%9A%84%E7%8E%AF%E5%A2%83/" target="_blank" rel="noopener">http://blog.hooperui.com/%E5%9C%A8sublime-text3%E4%B8%8A%E6%90%AD%E5%BB%BA%E9%80%82%E5%90%88react%E5%BC%80%E5%8F%91%E7%9A%84%E7%8E%AF%E5%A2%83/</a></p>
<h2 id="3-0-state和props和context的使用"><a href="#3-0-state和props和context的使用" class="headerlink" title="3.0 state和props和context的使用"></a>3.0 <code>state</code>和<code>props</code>和<code>context</code>的使用</h2><blockquote>
<p><code>state</code>和<code>props</code>的区别：</p>
<p>1.0 <code>props</code> 是组件的对外接口，<code>state</code> 是组件的内部状态，对外用<code>prop</code> ，内部用 <code>state</code>。</p>
<p>2.0 <code>prop</code>的赋值在外部世界使用组件时，<code>state</code>的赋值在组件内部</p>
<p>3.0 组件不应该改变<code>prop</code>的值，把<code>prop</code>赋值给<code>state</code>，然后改变<code>state</code>的值。</p>
</blockquote>
<h3 id="3-1-state"><a href="#3-1-state" class="headerlink" title="3.1 state"></a>3.1 <code>state</code></h3><p>在<code>react</code>中，组件自己的变化，不会引发视图的变化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123; <span class="comment">// 创建类 class 继承Component</span></span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            a : <span class="number">100</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    add () &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">a</span> : <span class="keyword">this</span>.state.a + <span class="number">1</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// 返回一个 jsx 语法</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">            	&lt;span&gt;&#123;<span class="keyword">this</span>.state.a&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">                &lt;p&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;input type="button" onClick = &#123;(this.add).bind(this)&#125;/</span>&gt; <span class="comment">// 这里需要bind绑定，如果使用apply和call会事先调用该函数</span></span><br><span class="line">                &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-props"><a href="#3-2-props" class="headerlink" title="3.2 props"></a>3.2 <code>props</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.js</span></span><br><span class="line"><span class="keyword">import</span> Mycom <span class="keyword">from</span> <span class="string">'./Mycom.js'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        retrun (</span><br><span class="line">        	&lt;Mycom a=&#123;<span class="number">66</span>&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Mycom</span>&gt;</span></span>  <span class="comment">// 这样就可以直接把 a=66 作为 props传参</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// MyCom.js</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mycom</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123; <span class="comment">// 创建类 class 继承Component</span></span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123; <span class="comment">//props本来是只能读，但是通过转化为state，就可以使用setState来改变</span></span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            a : props.a</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    add () &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">a</span> : <span class="keyword">this</span>.state.a + <span class="number">1</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// 返回一个 jsx 语法</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">            	&lt;span&gt;&#123;<span class="keyword">this</span>.state.a&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">                &lt;p&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;input type="button" onClick = &#123;(this.add).bind(this)&#125;/</span>&gt; <span class="comment">// 这里需要bind绑定，如果使用apply和call会事先调用该函数</span></span><br><span class="line">                &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-context可以进行组件传值"><a href="#3-3-context可以进行组件传值" class="headerlink" title="3.3 context可以进行组件传值"></a>3.3 <code>context</code>可以进行组件传值</h3><p>在数据源组件中定义想要传递的数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="title">extend</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    getChildContext()&#123; <span class="comment">// 理解为获取孙子组件的作用域，然后定义数据</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            text : <span class="string">'哈哈哈，我最帅'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;hello /&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">Index.childContextTypes = &#123; /</span><span class="regexp">/ 检测数据类型，传递给下一级</span></span><br><span class="line"><span class="regexp">    text : PropTypes.string</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>在目标组件中接收数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sun</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    construct(props, context)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="built_in">console</span>.log(context)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        &lt;div className=<span class="string">"hello"</span>&gt;</span><br><span class="line">        	这是接收数据的组件</span><br><span class="line">        	&#123; <span class="keyword">this</span>.context.text &#125;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">Sun.contextTypes = &#123;/</span><span class="regexp">/ 必须</span></span><br><span class="line"><span class="regexp">    text : PropTypes.string</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>context</code>进行传递数据时，必须在子级和父级都必须引入prop-types，在第一级父级中必须要有<code>getChildContext</code>函数和<code>childContextTypes</code>属性，其他子级中必须要有<code>contextTypes</code>属性，<code>context</code>的数据才能传递成功；不然无法传递</p>
</blockquote>
<p>参考：<a href="https://blog.csdn.net/qq_30101879/article/details/78448479" target="_blank" rel="noopener">https://blog.csdn.net/qq_30101879/article/details/78448479</a></p>
<h2 id="4-0reactjs的生命周期函数以及相应的使用场景"><a href="#4-0reactjs的生命周期函数以及相应的使用场景" class="headerlink" title="4.0reactjs的生命周期函数以及相应的使用场景"></a>4.0<code>reactjs</code>的生命周期函数以及相应的使用场景</h2><p><code>reactjs</code>的组件生命周期过程<img src="https://segmentfault.com/img/bVLTCt?w=2000&h=800" alt></p>
<h3 id="4-1-compoentWillMount"><a href="#4-1-compoentWillMount" class="headerlink" title="4.1 compoentWillMount"></a>4.1 <code>compoentWillMount</code></h3><p>该函数不适合大部分的组件使用</p>
<h3 id="4-2-componentDidMount"><a href="#4-2-componentDidMount" class="headerlink" title="4.2 componentDidMount"></a>4.2 <code>componentDidMount</code></h3><p>一般使用<code>ajax</code>请求数据，然后需要渲染在页面上时，就可以调用这个函数。</p>
<h3 id="4-3componentWillReceiveProps-nextProps"><a href="#4-3componentWillReceiveProps-nextProps" class="headerlink" title="4.3componentWillReceiveProps(nextProps)"></a>4.3<code>componentWillReceiveProps(</code>nextProps)</h3><ul>
<li>执行时间：组件已经渲染完成，当接收到新的<code>props</code>时会被调用；父组件向子组件传<code>props</code>时会被调用；</li>
<li>作用：渲染挂载组件</li>
<li>注意：<code>react</code>初次渲染时，该函数并不会被触发，因此有时该函数需要和<code>componentWillMount</code>或<code>componentDidMount</code>组合使用;使用该函数一定要加<code>nextProps</code>参数。</li>
</ul>
<h3 id="4-4-shouldComponentUpdate-nextProps-nextState"><a href="#4-4-shouldComponentUpdate-nextProps-nextState" class="headerlink" title="4.4 shouldComponentUpdate(nextProps, nextState)"></a>4.4 <code>shouldComponentUpdate(nextProps, nextState)</code></h3><ul>
<li>执行时间：组件挂载后（即执行完<code>render</code>），接收到新的state或props时被调用，即每次执行setstate都会执行该函数，来判断是否重新<code>render</code>组件，默认返回true；接收两个参数：第一个是新的props，第二个是新的state。</li>
<li>作用：如果有些变化不需要重新render组件，可以在该函数中阻拦</li>
</ul>
<h3 id="4-5-componentWillUpdate"><a href="#4-5-componentWillUpdate" class="headerlink" title="4.5 componentWillUpdate()"></a>4.5 <code>componentWillUpdate()</code></h3><ul>
<li>执行时间：在接收新的<code>props</code>或者<code>state</code>,重新渲染 之前立刻调用</li>
<li>不能使用<code>setState</code></li>
</ul>
<h3 id="4-6-componentDidUpdate"><a href="#4-6-componentDidUpdate" class="headerlink" title="4.6 componentDidUpdate()"></a>4.6 <code>componentDidUpdate()</code></h3><ul>
<li>执行时间：重新渲染后调用，在初始化渲染的时候该方法不会被调用</li>
<li>作用：<strong>使用该方法可以在组件更新之后操作DOM 元素</strong></li>
</ul>
<h3 id="4-7-componentWillUnmount"><a href="#4-7-componentWillUnmount" class="headerlink" title="4.7 componentWillUnmount()"></a>4.7 <code>componentWillUnmount()</code></h3><ul>
<li>执行时间：组件被卸载前调用，</li>
<li>作用：在该方法中执行任何必要的清理，比如无效的定时器，或者清除在 componentDidMount 中创建的 DOM 元素。</li>
</ul>
<h3 id="4-8-注意事项"><a href="#4-8-注意事项" class="headerlink" title="4.8 注意事项"></a>4.8 注意事项</h3><blockquote>
<p>当父组件需要先<code>ajax</code>获取值传递给子组件，然后子组件再<code>ajax</code>发送请求时，那么父子组件不能同时使用<code>componentDidMount</code>,因为会先执行子组件的的<code>componentDidMount</code>函数。</p>
<p>解决方案：</p>
<p>（1）父组件：componentWillMount，子组件：componentDidMount；</p>
<p>（2）父组件：componentWillMount，子组件：componentWillMount；</p>
</blockquote>
<p><strong>参考博客</strong>：<a href="https://blog.csdn.net/zrcj0706/article/details/78608740" target="_blank" rel="noopener">https://blog.csdn.net/zrcj0706/article/details/78608740</a></p>
<h2 id="5-0-reactjs的组件化"><a href="#5-0-reactjs的组件化" class="headerlink" title="5.0 reactjs的组件化"></a>5.0 <code>reactjs</code>的组件化</h2><blockquote>
<p>使用props进行传参，可以传递函数与变量。</p>
</blockquote>
<ul>
<li>在调用的组件中（即父组件）</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> Child <span class="keyword">from</span> <span class="string">'./child'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parents</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state=&#123;</span><br><span class="line">        msg:<span class="string">'父类的消息'</span>,</span><br><span class="line">        name:<span class="string">'爸爸'</span>,</span><br><span class="line">        age:<span class="number">100</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  callback=<span class="function">(<span class="params">msg,name,age</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(msg,name,age)  </span><br><span class="line">    <span class="comment">// setState方法,修改msg的值,值是由child里面传过来的</span></span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;msg&#125;);</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;name&#125;);</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;age&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">        &lt;p&gt; Message: &#123;<span class="keyword">this</span>.state.msg&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/ 将父组件的函数传给子组件          传递参数</span></span><br><span class="line"><span class="regexp">        &lt;Child callback=&#123;this.callback&#125; age=&#123;this.state.age&#125; name=&#123;this.state.name&#125; /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default Parents;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在子组件中（即封装的组件）</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state=&#123;</span><br><span class="line">            name:<span class="string">'儿子'</span>,</span><br><span class="line">            age:<span class="number">10</span>,</span><br><span class="line">            msg:<span class="string">"来自子类的消息"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    change=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">// 调用父组件的方法，该函数的作用域是在父组件里面。</span></span><br><span class="line">        <span class="comment">// 将这个组件的state参数传回父组件，进行运行，完成子组件向父组件通信，同时改变子组件。</span></span><br><span class="line">        <span class="keyword">this</span>.props.callback(<span class="keyword">this</span>.state.msg,<span class="keyword">this</span>.state.name,<span class="keyword">this</span>.state.age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;div&gt;&#123;<span class="keyword">this</span>.props.name&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                &lt;div&gt;&#123;this.props.age&#125;&lt;/</span>div&gt;</span><br><span class="line">                &lt;button onClick=&#123;<span class="keyword">this</span>.change&#125;&gt;点击&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Child;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>子组件接收的函数，作用域依旧是在父组件中，所以这样才能利用<code>props</code>完成子组件对父组件的通信。</p>
</blockquote>
<h3 id="5-1-全局使用加载中提示框"><a href="#5-1-全局使用加载中提示框" class="headerlink" title="5.1 全局使用加载中提示框"></a>5.1 全局使用加载中提示框</h3><ul>
<li>在<code>public/index.html</code>即入口html模板文件中创建一个相应的提示框，先进行隐藏。</li>
<li>在调用请求方法的组件中，进行相应的改变css属性。</li>
<li>加载提示框的组件从顶级父组件中进行引入。</li>
</ul>
<h2 id="6-0-Redux"><a href="#6-0-Redux" class="headerlink" title="6.0 Redux"></a>6.0 <code>Redux</code></h2><ul>
<li><code>store</code>是整个redux的总的状态容器，是一个对象。</li>
<li><code>action</code>是一个对象，表明该事件是什么样的事件，需要有<code>type</code>对象定义。</li>
<li><code>reducer</code>接收<code>state</code>状态和<code>action</code>，然后进行改变<code>state</code>。</li>
</ul>
<blockquote>
<p>应用中所有的 state 都以一个对象树的形式储存在一个单一的 <em>store</em> 中。 惟一改变 state 的办法是触发 <em>action</em>，一个描述发生什么的对象。 为了描述 action 如何改变 state 树，你需要编写 <em>reducers</em>。</p>
</blockquote>
<h3 id="6-1action"><a href="#6-1action" class="headerlink" title="6.1action"></a>6.1<code>action</code></h3><blockquote>
<p><code>action</code>只是描述事件的发生，但是并没有去更新<code>state</code></p>
</blockquote>
<ul>
<li><code>actionTypes</code>定义了<code>action</code>的常量</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ADD_TODO = <span class="string">'ADD_TODO'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在<code>action</code>中引入<code>actionTypes</code>里面的常量，并且使用<code>action</code>创建函数。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> types <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></span><br><span class="line"><span class="comment">// 下面函数中的 text 就是需要传入的数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addTodo = <span class="function"><span class="params">text</span> =&gt;</span> (&#123; <span class="attr">type</span>: types.ADD_TODO, text &#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>action.js中需要传入的参数与reducer.js中的需要传入的参数是对应的。</p>
</blockquote>
<h3 id="6-2-reducer"><a href="#6-2-reducer" class="headerlink" title="6.2 reducer"></a>6.2 <code>reducer</code></h3><p>在<code>/reducers/todo.js</code>下,进行修改state操作，但是只是返回一个新的<code>state</code>，原来的<code>state</code>不能改变，一并返回。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  ADD_TODO,</span><br><span class="line">  DELETE_TODO,</span><br><span class="line">  EDIT_TODO,</span><br><span class="line">  COMPLETE_TODO,</span><br><span class="line">  COMPLETE_ALL_TODOS,</span><br><span class="line">  CLEAR_COMPLETED</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState = [</span><br><span class="line">  &#123;</span><br><span class="line">    text: <span class="string">'Use Redux'</span>,</span><br><span class="line">    completed: <span class="literal">false</span>,</span><br><span class="line">    id: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> ADD_TODO:</span><br><span class="line">      <span class="keyword">return</span> [</span><br><span class="line">        ...state,</span><br><span class="line">        &#123;</span><br><span class="line">          id: state.reduce(<span class="function">(<span class="params">maxId, todo</span>) =&gt;</span> <span class="built_in">Math</span>.max(todo.id, maxId), <span class="number">-1</span>) + <span class="number">1</span>,</span><br><span class="line">          completed: <span class="literal">false</span>,</span><br><span class="line">          text: action.text <span class="comment">//这里是action，因为需要从子组件中向store的state中传递数据，从而再在子组件中获取数据。跟action中对应</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>初学者会对<code>todos(state = initialState, action)</code>不能理解，不清楚这个<code>action</code>和<code>state</code>的实参怎么传进来。</p>
</blockquote>
<ul>
<li><code>reducer</code>负责将<code>state</code>和<code>action</code>一并与组件连通。而<code>connect</code>负责把<code>store</code>与本组件连通。</li>
</ul>
<p><code>connect</code>函数有2个参数，</p>
<blockquote>
<p>mapStateToProps 就是将state作为props绑定到组件上，可以只绑定部分state。</p>
<p>mapDispatchToProps是可选的，将 action 作为 props 绑定到本组件上。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.props)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">            <span class="comment">// 点击触发getPost函数，进行dispatch分发</span></span><br><span class="line">                &lt;button onClick=&#123;<span class="keyword">this</span>.props.getPost&#125;&gt;点击增加&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">                &#123;this.props.counter.count&#125;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, ownProps</span>) =&gt;</span> (&#123;</span><br><span class="line">    counter: state.counterReducer</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ownProps是父组件传给子组件的props</span></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch, ownProps</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        getPost: <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 这里返回的是一个函数，注入到props中，dispatch就代表触发这个函数，所以需要有触发条件</span></span><br><span class="line">            dispatch(&#123;</span><br><span class="line">                type: <span class="string">'COUNT_ADD'</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(List)</span><br></pre></td></tr></table></figure>

<p>在组件中使用<code>connect</code>,然后在根组件中引入该组件。</p>
<blockquote>
<p>一般会有多个reducer.js文件，所以可以使用<code>combineReducers</code>将所有的子文件连结起来。最后在index.js使用</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> todos <span class="keyword">from</span> <span class="string">'./todos'</span></span><br><span class="line"><span class="keyword">import</span> visibilityFilter <span class="keyword">from</span> <span class="string">'./visibilityFilter'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootReducer = combineReducers(&#123;</span><br><span class="line">  todos,</span><br><span class="line">  visibilityFilter</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> rootReducer</span><br></pre></td></tr></table></figure>

<ul>
<li>在根组件使用要创建<code>store</code>,这个是store是和connect相配套的。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./components/App'</span></span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducers'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer) <span class="comment">//这里默认引入的是reducer文件下的根组件</span></span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Provider&gt;,</span></span><br><span class="line"><span class="regexp">  document.getElementById('root')</span></span><br><span class="line"><span class="regexp">)</span></span><br></pre></td></tr></table></figure>

<h2 id="7-0-React动画的实现"><a href="#7-0-React动画的实现" class="headerlink" title="7.0 React动画的实现"></a>7.0 <code>React</code>动画的实现</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> TransitionGroup <span class="keyword">from</span> <span class="string">'react-addons-css-transition-group'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TodoList = <span class="function">(<span class="params">&#123;todos&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;TransitionGroup transitionName=<span class="string">"fade"</span> transitionEnterTimeout=&#123;<span class="number">500</span>&#125; transitionLeaveTimeout=&#123;<span class="number">200</span>&#125;&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      todos.map(<span class="function">(<span class="params">item</span>) =&gt;</span> (</span><br><span class="line">        &lt;TodoItem</span><br><span class="line">          key=&#123;item.id&#125;</span><br><span class="line">          id=&#123;item.id&#125;</span><br><span class="line">          text=&#123;item.text&#125;</span><br><span class="line">          completed=&#123;item.completed&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        ))</span><br><span class="line">    &#125;</span><br><span class="line">      &lt;<span class="regexp">/TransitionGroup&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/u</span>l&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">TodoList.propTypes = &#123;</span><br><span class="line">  todos: PropTypes.array.isRequired</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// todos作为props传入本组件</span></span><br><span class="line">    todos: selectVisibleTodos(state)</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(TodoList);</span><br></pre></td></tr></table></figure>

<p>需要先安装<code>react-addons-css-transition-group</code>,<code>transitionName</code>可以自己命名，比如<code>fade</code>，那么在相应的css文件中的动画类名就需要加上<code>fade</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.fade-enter</span>&#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.01</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-enter</span><span class="selector-class">.fade-enter-active</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  transition: opacity 500ms ease-in;//这里的500ms需要与组件的相对应的props一样。</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-leave</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-leave</span><span class="selector-class">.fade-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.01</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">200ms</span> ease-in;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-1React-Motion动画的实现"><a href="#7-1React-Motion动画的实现" class="headerlink" title="7.1React-Motion动画的实现"></a>7.1<code>React-Motion</code>动画的实现</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;spring, TransitionMotion&#125; <span class="keyword">from</span> <span class="string">'react-motion'</span>;</span><br><span class="line"><span class="comment">// 表示动画离开的时候，这里需要使用 spring</span></span><br><span class="line"><span class="keyword">const</span> willLeave = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    height: spring(<span class="number">0</span>),</span><br><span class="line">    opacity: spring(<span class="number">0</span>)</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//表示进入动画的时候，即初始状态</span></span><br><span class="line"><span class="keyword">const</span> willEnter = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    height: <span class="number">0</span>,</span><br><span class="line">    opacity: <span class="number">0</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> getStyles = <span class="function">(<span class="params">todos</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> todos.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      key: item.id.toString(),</span><br><span class="line">      data: item,</span><br><span class="line">      style: &#123; <span class="comment">// 这里的 style 表示动画的目标状态</span></span><br><span class="line">        height: spring(<span class="number">60</span>),</span><br><span class="line">        opacity: spring(<span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TodoList = <span class="function">(<span class="params">&#123;todos&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> styles = getStyles(todos);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;TransitionMotion</span><br><span class="line">      willLeave=&#123;willLeave&#125;</span><br><span class="line">      willEnter=&#123;willEnter&#125;</span><br><span class="line">      styles=&#123;styles&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;<span class="comment">/* TransitionMotion 只能包含</span></span><br><span class="line"><span class="comment">          函数作为子组件，而且这个函数只能返回一个元素，不能是一个数组作为元素， </span></span><br><span class="line"><span class="comment">          TranistionMotion 不是 ul 的子组件， ul 被移到了 TranistionMotion</span></span><br><span class="line"><span class="comment">          的子组件函数内部，用于把所有 Todoltem 包裹为一个元素返回 */</span>&#125;</span><br><span class="line">      &#123;</span><br><span class="line">        interpolatedStyles =&gt;</span><br><span class="line">        &lt;ul className=<span class="string">"todo-list"</span>&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            interpolatedStyles.map(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">const</span> &#123;data, style, key&#125; = config;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">const</span> item = data;</span><br><span class="line">              <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">TodoItem</span></span></span></span><br><span class="line"><span class="xml">                style=&#123;style&#125;</span></span><br><span class="line"><span class="xml">                key=&#123;key&#125;</span></span><br><span class="line"><span class="xml">                id=&#123;item.id&#125;</span></span><br><span class="line"><span class="xml">                text=&#123;item.text&#125;</span></span><br><span class="line"><span class="xml">                completed=&#123;item.completed&#125;</span></span><br><span class="line"><span class="xml">              /&gt;);</span></span><br><span class="line"><span class="xml">            &#125;)</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">        <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    todos: selectVisibleTodos(state)</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(TodoList);</span><br><span class="line">      &lt;<span class="regexp">/TransitionMotion&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">const mapStateToProps = (state) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  return &#123;</span></span><br><span class="line"><span class="regexp">    todos: selectVisibleTodos(state)</span></span><br><span class="line"><span class="regexp">  &#125;;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default connect(mapStateToProps)(TodoList);</span></span><br></pre></td></tr></table></figure>

<h2 id="8-0-在浏览器上使用REDUX-DEVTOOLS"><a href="#8-0-在浏览器上使用REDUX-DEVTOOLS" class="headerlink" title="8.0 在浏览器上使用REDUX_DEVTOOLS"></a>8.0 在浏览器上使用<code>REDUX_DEVTOOLS</code></h2><p>在<code>./index.tsx</code>中添加代码</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原来的方法会报错：window上不存在属性__REDUX_DEVTOOLS_EXTENSION__，</span></span><br><span class="line"><span class="comment">// 所以就全局声明一个变量</span></span><br><span class="line"><span class="keyword">declare</span> global &#123;</span><br><span class="line">    <span class="keyword">interface</span> Window &#123;</span><br><span class="line">        __REDUX_DEVTOOLS_EXTENSION__:<span class="built_in">any</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION__ || compose;</span><br><span class="line"><span class="comment">// 使用四个any不使用的话，躲不过类型检查</span></span><br><span class="line"><span class="keyword">const</span> store = createStore&lt;<span class="built_in">any</span>, <span class="built_in">any</span>, <span class="built_in">any</span>,<span class="built_in">any</span>&gt;(reducer, composeEnhancers())</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/使用git上传代码到github/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/使用git上传代码到github/" itemprop="url">使用git上传代码到github</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/git/" itemprop="url" rel="index">
                    <span itemprop="name">git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="使用git上传代码到github"><a href="#使用git上传代码到github" class="headerlink" title="使用git上传代码到github"></a>使用git上传代码到<code>github</code></h1><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>以前部署nodejs应用都是一直把整个文件（包含整个<code>node_modules</code>）一起把大文件通过ftp上传到服务器，然后通过<code>pm2</code>直接运行<code>app.js</code>就ok了</p>
<p><strong>这次就使用git部署到服务器上</strong></p>
<ul>
<li>流程：<em>先将本地代码上传到<code>github</code>仓库，然后再在服务器上从github上下载，最后在服务器上运行，为什么要有个中间商，是为了方便进行版本管理</em></li>
</ul>
<h2 id="1-0-拥有github仓库，并上传代码"><a href="#1-0-拥有github仓库，并上传代码" class="headerlink" title="1.0 拥有github仓库，并上传代码"></a>1.0 拥有github仓库，并上传代码</h2><ul>
<li>注册<code>github</code>账号，然后在自己本机与github账号建立密钥联系，你才能够上传代码到<code>github</code>上。</li>
</ul>
<h3 id="上传代码到github"><a href="#上传代码到github" class="headerlink" title="上传代码到github"></a>上传代码到<code>github</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先进入要上传的代码文件夹</span></span><br><span class="line">git init</span><br><span class="line">git add .	<span class="comment"># 表示将该文件夹下所有文件添加到本地仓库</span></span><br><span class="line">git commit -m <span class="string">'说明'</span></span><br><span class="line">git remote add origin https://github.com/good-idear/ghost-myselfcasper.git <span class="comment"># 这里的https表示你在github上新建的仓库</span></span><br><span class="line">git push -u origin master <span class="comment"># 上传到github</span></span><br></pre></td></tr></table></figure>

<ul>
<li>参考这篇文章：<a href="https://blog.csdn.net/longgeaisisi/article/details/78012406" target="_blank" rel="noopener">https://blog.csdn.net/longgeaisisi/article/details/78012406</a></li>
</ul>
<h2 id="2-0-在服务器上安装git"><a href="#2-0-在服务器上安装git" class="headerlink" title="2.0 在服务器上安装git"></a>2.0 在服务器上安装<code>git</code></h2><ul>
<li>参考这篇文章：<a href="https://www.jianshu.com/p/89a2917ff5c1" target="_blank" rel="noopener">https://www.jianshu.com/p/89a2917ff5c1</a></li>
</ul>
<h2 id="3-0-在服务器上启动项目"><a href="#3-0-在服务器上启动项目" class="headerlink" title="3.0 在服务器上启动项目"></a>3.0 在服务器上启动项目</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/部署node.js项目到ubuntu云服务器上/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="菜菜鸡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/部署node.js项目到ubuntu云服务器上/" itemprop="url">部署node.js项目到Ubuntu云服务器上</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T10:00:15+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index">
                    <span itemprop="name">nodejs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="部署node-js项目到Ubuntu云服务器上"><a href="#部署node-js项目到Ubuntu云服务器上" class="headerlink" title="部署node.js项目到Ubuntu云服务器上"></a>部署node.js项目到Ubuntu云服务器上</h1><h2 id="1-0-购买完阿里云服务器之后的步骤"><a href="#1-0-购买完阿里云服务器之后的步骤" class="headerlink" title="1.0 购买完阿里云服务器之后的步骤"></a>1.0 购买完阿里云服务器之后的步骤</h2><ul>
<li>配置安全组</li>
</ul>
<blockquote>
<p>阿里云服务器如果不配置安全组，那么在项目部署到服务器之后不能通过外网（即浏览器）访问，也不能够使用xshell或者putty远程连接服务器，所以目前的配置安全组是为了可以远程连接服务器</p>
</blockquote>
<ul>
<li>配置安全组规则</li>
</ul>
<p>端口‘22’为可以进行linux(ssh)访问，端口‘21’进行sftp访问，端口3389为windows访问，假设允许公网上所有IP地址访问您的网站，则需要开放‘80’，‘443’，‘自定义端口’</p>
<h2 id="2-0-使用xshell连接远程服务器"><a href="#2-0-使用xshell连接远程服务器" class="headerlink" title="2.0 使用xshell连接远程服务器"></a>2.0 使用xshell连接远程服务器</h2><ul>
<li>下载xshell</li>
<li>进入阿里云官网，点击创建密钥（现在都需要密钥连接），选择自动新建密钥，将生成的密钥对文件下载下来，创建之后，绑定密钥对，重启服务器。</li>
<li>进入xshell ，新建一个连接，输入服务器的外网IP，点击用户身份验证，方法选择密钥，将密钥对（即之前在阿里云下载下来的密钥）导入xshell中,期间输入的密码不是云服务器的密码或者远程连接密码。点击连接就可以了。</li>
</ul>
<h2 id="3-0-在服务器上安装node-js环境"><a href="#3-0-在服务器上安装node-js环境" class="headerlink" title="3.0 在服务器上安装node.js环境"></a>3.0 在服务器上安装node.js环境</h2><p>我之前在ubuntu下的root用户安装过nvm，但是创建了新用户之后，新用户就没有node的使用权，显示没有安装nvm,所以这次需要在新用户下安装nvm，那么在root权限下也可以调用nvm</p>
<ul>
<li>先安装 nvm</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//这里使用的nvm全局安装，会安装在/usr/local/nvm下</span><br><span class="line">//github地址：https://github.com/xtuple/nvm</span><br><span class="line">wget -qO- https://raw.githubusercontent.com/xtuple/nvm/master/install.sh | sudo bash</span><br></pre></td></tr></table></figure>

<ul>
<li>安装npm(就是这里的坑)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo nvm install v8.12.0	//只是暂时性的使用这个版本，断开连接之后会显示没有node版本</span><br><span class="line">$ sudo nvm <span class="built_in">alias</span> default v8.12.0  //默认使用该版本，则断开连接依旧显示有 node 版本存在</span><br></pre></td></tr></table></figure>

<ul>
<li>使用淘宝镜像</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line">//配置后可通过下面方式来验证是否成功</span><br><span class="line">npm config get registry</span><br><span class="line">//使之可以使用cnpm命令</span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>

<h2 id="4-0-在云服务器上安装mongodb"><a href="#4-0-在云服务器上安装mongodb" class="headerlink" title="4.0 在云服务器上安装mongodb"></a>4.0 在云服务器上安装mongodb</h2><ul>
<li>先下载压缩包，不论在服务器上还是在自己电脑上下载，记得下载服务器版本的mongodb,放在根目录下的 /usr/local 里面</li>
<li>使用命令解压</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf mongodb-linux-x86_64-3.4.5.tgz			//解压会多出一个mongodb-linux-x86_64-3.4.5文件</span><br><span class="line">mv mongodb-linux-x86_64-3.4.5 mongodb 		//将这个文件重命名为mongodb</span><br></pre></td></tr></table></figure>

<ul>
<li>配置环境变量。将 mongodb的bin目录添加到系统环境的PATH中，修改 /etc/profile文件，这样所有的用户都能使用到</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/profile</span><br><span class="line">//在打开的文件里面加一句环境变量</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/mongodb/bin		//保存退出</span><br></pre></td></tr></table></figure>

<ul>
<li>编辑mongodb的配置文件mongod.conf</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建并编辑 mongod.conf，然后保存</span></span><br><span class="line">sudo vi /etc/mongod.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 内容是 ---</span></span><br><span class="line"><span class="comment"># 详细记录输出 </span></span><br><span class="line">verbose = <span class="literal">true</span> </span><br><span class="line"><span class="comment"># 指定服务端口号,默认端口27017 </span></span><br><span class="line">port = 27017 </span><br><span class="line"><span class="comment"># 指定MongoDB日志文件,注意是指定文件不是目录 </span></span><br><span class="line">logpath = /var/<span class="built_in">log</span>/mongodb/logs/mongodb.log </span><br><span class="line"><span class="comment"># 使用追加的方式写日志 </span></span><br><span class="line">logappend = <span class="literal">true</span> </span><br><span class="line"><span class="comment"># 指定数据库路径 </span></span><br><span class="line">dbpath = /data/db/ </span><br><span class="line"><span class="comment">#设置每个数据库将被保存在一个单独的目录 </span></span><br><span class="line">directoryperdb = <span class="literal">true</span> </span><br><span class="line"><span class="comment"># 启用验证 </span></span><br><span class="line">auth = <span class="literal">false</span> </span><br><span class="line"><span class="comment">#以守护进程的方式运行MongoDB,创建服务器进程,fork 参数代表使mongodb随服务器一直运行，但是在这里似乎没有什么作用</span></span><br><span class="line">fork = <span class="literal">true</span> </span><br><span class="line"><span class="comment">#安静输出 </span></span><br><span class="line">quiet = <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>设置数据库的日志和存储路径</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">创建保存数据文件的数据库目录</span><br><span class="line">mkdir -p /data/db/</span><br><span class="line">创建日志目录和日志文件</span><br><span class="line">mkdir -p /var/<span class="built_in">log</span>/mongodb/logs/</span><br><span class="line">touch /var/<span class="built_in">log</span>/mongodb/logs/mongodb.log   // touch创建的可编辑文件，mkdir 创建的是文件夹</span><br></pre></td></tr></table></figure>

<ul>
<li>如果到了这里没有问题的话，可以使用命令连接数据库</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mongod		//连接数据库，类似于windows 的 net start mongodb</span><br><span class="line">mongo		//新开一个连接，启动数据库，可以进行数据操作</span><br></pre></td></tr></table></figure>

<ul>
<li>如果上面的都没错，那么就可以设置数据库为一直连接状态</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$./mongod --fork --dbpath &lt;数据库存储的绝对路径&gt; --syslog</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里需要进入mongodb的文件下，即当初重命名的文件里面，在/usr/local/mongodb/bin里面使用命令</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ./mongod --fork --dbpath /data/db --syslog		//这样就可以在后台一直运行</span><br></pre></td></tr></table></figure>

<ul>
<li><p>杀死 mongodb 进程，即可关闭 mongodb 服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -15 PID</span><br></pre></td></tr></table></figure>
</li>
<li><p>大佬的教程：<a href="https://www.linuxidc.com/Linux/2016-06/132675.htm" target="_blank" rel="noopener">https://www.linuxidc.com/Linux/2016-06/132675.htm</a></p>
</li>
</ul>
<h2 id="5-0-在云服务器上安装mysql"><a href="#5-0-在云服务器上安装mysql" class="headerlink" title="5.0 在云服务器上安装mysql"></a>5.0 在云服务器上安装mysql</h2><ul>
<li>更新系统 <code>sudo apt-get update</code></li>
<li>安装mysql-server</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mysql-server  //在这其中会要求输入密码，自己设置，在输入框中输完按回车，记住。进入mysql也需要密码</span><br><span class="line">sudo apt-get isntall mysql-client </span><br><span class="line">sudo apt-get install libmysqlclient-dev</span><br></pre></td></tr></table></figure>

<ul>
<li>使用如下命令查询是否安装成功：<code>sudo netstat -tap | grep mysql</code>,出现mysql 就成功了</li>
<li>登录 mysql <code>mysql -uroot -p123456</code>,这里的<code>123456</code>是之前设置的密码。</li>
<li>退出 <code>exit</code>命令</li>
</ul>
<h2 id="6-0-使用pm2进行持久化运行项目"><a href="#6-0-使用pm2进行持久化运行项目" class="headerlink" title="6.0 使用pm2进行持久化运行项目"></a>6.0 使用pm2进行持久化运行项目</h2><ul>
<li>在启动代码之前需要将监听端口在安全组规则里面设置，可以是’80’,也可以是自定义的端口（5000），但是都需要在安全组规则里面配置所监听的端口。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g pm2</span><br><span class="line">pm2 start app.js		//就可以持久运行项目</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="菜菜鸡">
            
              <p class="site-author-name" itemprop="name">菜菜鸡</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/good-idear" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="1359064950@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/guo-shi-wu-shuang-35-7/activities" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-globe"></i>知乎</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">菜菜鸡</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  


  <!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>
</body>
</html>
